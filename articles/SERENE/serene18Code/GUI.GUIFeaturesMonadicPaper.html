<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>GUI.GUIFeaturesMonadicPaper</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">-- \GUIFeaturesMonadicPaper</a>
<a id="29" class="Keyword">module</a> <a id="36" href="GUI.GUIFeaturesMonadicPaper.html" class="Module">GUI.GUIFeaturesMonadicPaper</a> <a id="64" class="Keyword">where</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Data.List.html" class="Module">Data.List</a>
<a id="138" class="Keyword">open</a> <a id="143" class="Keyword">import</a> <a id="150" href="Data.Product.html" class="Module">Data.Product</a> <a id="163" class="Keyword">hiding</a> <a id="170" class="Symbol">(</a><a id="171" href="Data.Product.html#2808" class="Function">swap</a><a id="175" class="Symbol">)</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="198" class="Keyword">renaming</a> <a id="207" class="Symbol">(</a><a id="208" href="Data.Sum.Base.html#1138" class="Function">map</a> <a id="212" class="Symbol">to</a> <a id="215" href="Data.Sum.Base.html#1138" class="Function">map+</a><a id="219" class="Symbol">)</a>
<a id="221" class="Keyword">open</a> <a id="226" class="Keyword">import</a> <a id="233" href="Data.String.Base.html" class="Module">Data.String.Base</a>
<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Size.html" class="Module">Size</a>

<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="SizedIO.Base.html" class="Module">SizedIO.Base</a> <a id="293" class="Keyword">renaming</a> <a id="302" class="Symbol">(</a><a id="303" href="SizedIO.Base.html#540" class="Record">IO</a> <a id="306" class="Symbol">to</a> <a id="309" href="SizedIO.Base.html#540" class="Record">IO∞</a><a id="312" class="Symbol">;</a> <a id="314" href="SizedIO.Base.html#681" class="Datatype">IO&#39;</a> <a id="318" class="Symbol">to</a> <a id="321" href="SizedIO.Base.html#681" class="Datatype">IO</a><a id="323" class="Symbol">)</a> <a id="325" class="Keyword">hiding</a> <a id="332" class="Symbol">(</a><a id="333" href="SizedIO.Base.html#1730" class="Function Operator">_&gt;&gt;=_</a> <a id="339" class="Symbol">;</a> <a id="341" href="SizedIO.Base.html#1840" class="Function Operator">_&gt;&gt;_</a> <a id="346" class="Symbol">;</a> <a id="348" href="SizedIO.Base.html#1288" class="Function">return</a><a id="354" class="Symbol">)</a>

<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="NativeIO.html" class="Module">NativeIO</a>

<a id="379" class="Keyword">open</a> <a id="384" class="Keyword">import</a> <a id="391" href="GUI.GUIDefinitions.html" class="Module">GUI.GUIDefinitions</a>

<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="GUI.GUICompilationFeatures.html" class="Module">GUI.GUICompilationFeatures</a> <a id="450" class="Keyword">using</a> <a id="456" class="Symbol">(</a><a id="457" href="GUI.GUICompilationFeatures.html#1984" class="Function">compileSMachine</a><a id="472" class="Symbol">)</a>

<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="GUI.GUIFeatures.html" class="Module">GUI.GUIFeatures</a> <a id="503" class="Keyword">using</a> <a id="509" class="Symbol">(</a><a id="510" href="GUI.GUIFeatures.html#635" class="Datatype">FeatureTea</a><a id="520" class="Symbol">;</a> <a id="522" href="GUI.GUIFeatures.html#753" class="Datatype">FeatureCancel</a><a id="535" class="Symbol">;</a> <a id="537" href="GUI.GUIFeatures.html#692" class="Datatype">FeatureFree</a><a id="548" class="Symbol">;</a> <a id="550" href="GUI.GUIFeatures.html#660" class="InductiveConstructor">yesTea</a><a id="556" class="Symbol">;</a> <a id="558" href="GUI.GUIFeatures.html#781" class="InductiveConstructor">yesCancel</a><a id="567" class="Symbol">;</a> <a id="569" href="GUI.GUIFeatures.html#726" class="InductiveConstructor">noFree</a><a id="575" class="Symbol">;</a> <a id="577" href="GUI.GUIFeatures.html#718" class="InductiveConstructor">yesFree</a><a id="584" class="Symbol">)</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="GUI.GUIFeaturesPart2Paper.html" class="Module">GUI.GUIFeaturesPart2Paper</a> <a id="624" class="Keyword">hiding</a> <a id="631" class="Symbol">(</a><a id="632" href="GUI.GUIFeaturesPart2Paper.html#1254" class="Record">FeatureMachine</a> <a id="647" class="Symbol">;</a> <a id="649" href="GUI.GUIFeaturesPart2Paper.html#1110" class="Record">FeatureMachineNaive</a><a id="668" class="Symbol">;</a> <a id="670" href="GUI.GUIFeaturesPart2Paper.html#646" class="Function">IO</a><a id="672" class="Symbol">)</a>
<a id="674" class="Keyword">open</a> <a id="679" class="Keyword">import</a> <a id="686" href="GUI.GUIFeaturesPart3.html" class="Module">GUI.GUIFeaturesPart3</a> <a id="707" class="Keyword">hiding</a> <a id="714" class="Symbol">(</a> <a id="716" href="GUI.GUIFeaturesPart3.html#3365" class="Function">main</a> <a id="721" class="Symbol">;</a> <a id="723" href="GUI.GUIFeaturesPart3.html#2063" class="Function">Tea</a> <a id="727" class="Symbol">;</a> <a id="729" href="GUI.GUIFeaturesPart3.html#1450" class="Function">Cancel</a><a id="735" class="Symbol">;</a> <a id="737" href="GUI.GUIFeaturesPart3.html#2899" class="Function">main1</a> <a id="743" class="Symbol">;</a> <a id="745" href="GUI.GUIFeaturesPart3.html#3135" class="Function">main2</a><a id="750" class="Symbol">)</a>
<a id="752" class="Keyword">open</a> <a id="757" class="Keyword">import</a> <a id="764" href="GUI.GUIFeaturesPart8Paper.html" class="Module">GUI.GUIFeaturesPart8Paper</a>

<a id="791" class="Keyword">open</a> <a id="796" class="Keyword">import</a> <a id="803" href="SizedIO.Console.html" class="Module">SizedIO.Console</a>
<a id="819" class="Comment">{-
mapStateMachineState : {S S&#39; : Set}(f : S → S&#39;)
                   → StateMachineState S
                   → StateMachineState S&#39;
mapStateMachineState {S}{S&#39;} f m = ?
-}</a>

<a id="994" class="Comment">-- StateMachineMonadic A S</a>
<a id="1021" class="Comment">--  is like an StateMachine, but it has additional return values in A</a>

<a id="1092" class="Comment">-- \GUIFeaturesMonadicPaper</a>
<a id="StateMachineMonadic"></a><a id="1120" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="1140" class="Symbol">:</a> <a id="1142" class="Symbol">(</a><a id="1143" href="GUI.GUIFeaturesMonadicPaper.html#1143" class="Bound">A</a>  <a id="1146" href="GUI.GUIFeaturesMonadicPaper.html#1146" class="Bound">S</a> <a id="1148" class="Symbol">:</a> <a id="1150" class="PrimitiveType">Set</a><a id="1153" class="Symbol">)</a> <a id="1155" class="Symbol">→</a> <a id="1157" class="PrimitiveType">Set</a>
<a id="1161" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="1181" href="GUI.GUIFeaturesMonadicPaper.html#1181" class="Bound">A</a> <a id="1183" href="GUI.GUIFeaturesMonadicPaper.html#1183" class="Bound">S</a>  <a id="1186" class="Symbol">=</a> <a id="1188" href="GUI.GUIFeaturesMonadicPaper.html#1183" class="Bound">S</a> <a id="1190" class="Symbol">→</a> <a id="1192" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="1205" class="Symbol">(</a><a id="1206" href="GUI.GUIFeaturesMonadicPaper.html#1183" class="Bound">S</a> <a id="1208" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="1210" href="GUI.GUIFeaturesMonadicPaper.html#1181" class="Bound">A</a><a id="1211" class="Symbol">)</a>

<a id="FeatureMachineMonadic"></a><a id="1214" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="1236" class="Symbol">:</a> <a id="1238" class="Symbol">(</a><a id="1239" href="GUI.GUIFeaturesMonadicPaper.html#1239" class="Bound">A</a> <a id="1241" href="GUI.GUIFeaturesMonadicPaper.html#1241" class="Bound">F</a> <a id="1243" href="GUI.GUIFeaturesMonadicPaper.html#1243" class="Bound">S</a> <a id="1245" class="Symbol">:</a> <a id="1247" class="PrimitiveType">Set</a><a id="1250" class="Symbol">)</a> <a id="1252" class="Symbol">→</a> <a id="1254" class="PrimitiveType">Set</a>
<a id="1258" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="1280" href="GUI.GUIFeaturesMonadicPaper.html#1280" class="Bound">A</a> <a id="1282" href="GUI.GUIFeaturesMonadicPaper.html#1282" class="Bound">F</a> <a id="1284" href="GUI.GUIFeaturesMonadicPaper.html#1284" class="Bound">S</a> <a id="1286" class="Symbol">=</a> <a id="1288" class="Symbol">(</a><a id="1289" href="GUI.GUIFeaturesMonadicPaper.html#1289" class="Bound">f</a> <a id="1291" class="Symbol">:</a> <a id="1293" href="GUI.GUIFeaturesMonadicPaper.html#1282" class="Bound">F</a><a id="1294" class="Symbol">)</a> <a id="1296" class="Symbol">→</a> <a id="1298" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="1318" href="GUI.GUIFeaturesMonadicPaper.html#1280" class="Bound">A</a> <a id="1320" href="GUI.GUIFeaturesMonadicPaper.html#1284" class="Bound">S</a>

<a id="mapMachineState"></a><a id="1323" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a> <a id="1339" class="Symbol">:</a> <a id="1341" class="Symbol">{</a><a id="1342" href="GUI.GUIFeaturesMonadicPaper.html#1342" class="Bound">S</a> <a id="1344" href="GUI.GUIFeaturesMonadicPaper.html#1344" class="Bound">S&#39;</a> <a id="1347" class="Symbol">:</a> <a id="1349" class="PrimitiveType">Set</a><a id="1352" class="Symbol">}(</a><a id="1354" href="GUI.GUIFeaturesMonadicPaper.html#1354" class="Bound">f</a> <a id="1356" class="Symbol">:</a> <a id="1358" href="GUI.GUIFeaturesMonadicPaper.html#1342" class="Bound">S</a> <a id="1360" class="Symbol">→</a> <a id="1362" href="GUI.GUIFeaturesMonadicPaper.html#1344" class="Bound">S&#39;</a><a id="1364" class="Symbol">)(</a><a id="1366" href="GUI.GUIFeaturesMonadicPaper.html#1366" class="Bound">sm</a> <a id="1369" class="Symbol">:</a> <a id="1371" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="1384" href="GUI.GUIFeaturesMonadicPaper.html#1342" class="Bound">S</a><a id="1385" class="Symbol">)</a>
                    <a id="1407" class="Symbol">→</a> <a id="1409" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="1422" href="GUI.GUIFeaturesMonadicPaper.html#1344" class="Bound">S&#39;</a>
<a id="1425" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a> <a id="1441" href="GUI.GUIFeaturesMonadicPaper.html#1441" class="Bound">f</a> <a id="1443" href="GUI.GUIFeaturesMonadicPaper.html#1443" class="Bound">sm</a> <a id="1446" class="Symbol">.</a><a id="1447" href="GUI.GUIFeaturesPart2Paper.html#864" class="Field">view</a> <a id="1452" class="Symbol">=</a> <a id="1454" href="GUI.GUIFeaturesMonadicPaper.html#1443" class="Bound">sm</a> <a id="1457" class="Symbol">.</a><a id="1458" href="GUI.GUIFeaturesPart2Paper.html#864" class="Field">view</a>
<a id="1463" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a> <a id="1479" href="GUI.GUIFeaturesMonadicPaper.html#1479" class="Bound">f</a> <a id="1481" href="GUI.GUIFeaturesMonadicPaper.html#1481" class="Bound">sm</a> <a id="1484" class="Symbol">.</a><a id="1485" href="GUI.GUIFeaturesPart2Paper.html#883" class="Field">handleUserInput</a> <a id="1501" href="GUI.GUIFeaturesMonadicPaper.html#1501" class="Bound">m</a> <a id="1503" class="Symbol">=</a> <a id="1505" href="GUI.GUIFeaturesPart3.html#686" class="Function">mapStateMachineHandl</a> <a id="1526" href="GUI.GUIFeaturesMonadicPaper.html#1479" class="Bound">f</a> <a id="1528" class="Symbol">(</a><a id="1529" href="GUI.GUIFeaturesMonadicPaper.html#1481" class="Bound">sm</a> <a id="1532" class="Symbol">.</a><a id="1533" href="GUI.GUIFeaturesPart2Paper.html#883" class="Field">handleUserInput</a> <a id="1549" href="GUI.GUIFeaturesMonadicPaper.html#1501" class="Bound">m</a><a id="1550" class="Symbol">)</a>


<a id="mapStateMachineReturnMonadic"></a><a id="1554" href="GUI.GUIFeaturesMonadicPaper.html#1554" class="Function">mapStateMachineReturnMonadic</a> <a id="1583" class="Symbol">:</a> <a id="1585" class="Symbol">{</a><a id="1586" href="GUI.GUIFeaturesMonadicPaper.html#1586" class="Bound">A</a> <a id="1588" href="GUI.GUIFeaturesMonadicPaper.html#1588" class="Bound">A&#39;</a> <a id="1591" class="Symbol">:</a> <a id="1593" class="PrimitiveType">Set</a><a id="1596" class="Symbol">}(</a><a id="1598" href="GUI.GUIFeaturesMonadicPaper.html#1598" class="Bound">f</a> <a id="1600" class="Symbol">:</a> <a id="1602" href="GUI.GUIFeaturesMonadicPaper.html#1586" class="Bound">A</a> <a id="1604" class="Symbol">→</a> <a id="1606" href="GUI.GUIFeaturesMonadicPaper.html#1588" class="Bound">A&#39;</a><a id="1608" class="Symbol">){</a><a id="1610" href="GUI.GUIFeaturesMonadicPaper.html#1610" class="Bound">S</a> <a id="1612" class="Symbol">:</a> <a id="1614" class="PrimitiveType">Set</a><a id="1617" class="Symbol">}</a>
                           <a id="1646" class="Symbol">(</a><a id="1647" href="GUI.GUIFeaturesMonadicPaper.html#1647" class="Bound">machine</a> <a id="1655" class="Symbol">:</a> <a id="1657" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="1677" href="GUI.GUIFeaturesMonadicPaper.html#1586" class="Bound">A</a> <a id="1679" href="GUI.GUIFeaturesMonadicPaper.html#1610" class="Bound">S</a><a id="1680" class="Symbol">)</a>
                           <a id="1709" class="Symbol">→</a> <a id="1711" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="1731" href="GUI.GUIFeaturesMonadicPaper.html#1588" class="Bound">A&#39;</a> <a id="1734" href="GUI.GUIFeaturesMonadicPaper.html#1610" class="Bound">S</a>
<a id="1736" href="GUI.GUIFeaturesMonadicPaper.html#1554" class="Function">mapStateMachineReturnMonadic</a> <a id="1765" class="Symbol">{</a><a id="1766" href="GUI.GUIFeaturesMonadicPaper.html#1766" class="Bound">A</a><a id="1767" class="Symbol">}</a> <a id="1769" class="Symbol">{</a><a id="1770" href="GUI.GUIFeaturesMonadicPaper.html#1770" class="Bound">A&#39;</a><a id="1772" class="Symbol">}</a> <a id="1774" href="GUI.GUIFeaturesMonadicPaper.html#1774" class="Bound">f</a> <a id="1776" class="Symbol">{</a><a id="1777" href="GUI.GUIFeaturesMonadicPaper.html#1777" class="Bound">S</a><a id="1778" class="Symbol">}</a> <a id="1780" href="GUI.GUIFeaturesMonadicPaper.html#1780" class="Bound">machine</a>  <a id="1789" href="GUI.GUIFeaturesMonadicPaper.html#1789" class="Bound">s</a> <a id="1791" class="Symbol">=</a>
     <a id="1798" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a>  <a id="1815" class="Symbol">(</a><a id="1816" href="Data.Sum.Base.html#1138" class="Function">map+</a> <a id="1821" class="Symbol">(λ</a> <a id="1824" href="GUI.GUIFeaturesMonadicPaper.html#1824" class="Bound">x</a> <a id="1826" class="Symbol">→</a> <a id="1828" href="GUI.GUIFeaturesMonadicPaper.html#1824" class="Bound">x</a><a id="1829" class="Symbol">)</a> <a id="1831" href="GUI.GUIFeaturesMonadicPaper.html#1774" class="Bound">f</a><a id="1832" class="Symbol">)</a> <a id="1834" class="Symbol">(</a><a id="1835" href="GUI.GUIFeaturesMonadicPaper.html#1780" class="Bound">machine</a> <a id="1843" href="GUI.GUIFeaturesMonadicPaper.html#1789" class="Bound">s</a><a id="1844" class="Symbol">)</a>


<a id="mapFeatureMach"></a><a id="1848" href="GUI.GUIFeaturesMonadicPaper.html#1848" class="Function">mapFeatureMach</a> <a id="1863" class="Symbol">:</a> <a id="1865" class="Symbol">{</a><a id="1866" href="GUI.GUIFeaturesMonadicPaper.html#1866" class="Bound">A</a> <a id="1868" href="GUI.GUIFeaturesMonadicPaper.html#1868" class="Bound">F</a> <a id="1870" href="GUI.GUIFeaturesMonadicPaper.html#1870" class="Bound">A&#39;</a> <a id="1873" class="Symbol">:</a> <a id="1875" class="PrimitiveType">Set</a><a id="1878" class="Symbol">}(</a><a id="1880" href="GUI.GUIFeaturesMonadicPaper.html#1880" class="Bound">g</a> <a id="1882" class="Symbol">:</a> <a id="1884" href="GUI.GUIFeaturesMonadicPaper.html#1866" class="Bound">A</a> <a id="1886" class="Symbol">→</a> <a id="1888" href="GUI.GUIFeaturesMonadicPaper.html#1870" class="Bound">A&#39;</a><a id="1890" class="Symbol">){</a><a id="1892" href="GUI.GUIFeaturesMonadicPaper.html#1892" class="Bound">S</a> <a id="1894" class="Symbol">:</a> <a id="1896" class="PrimitiveType">Set</a><a id="1899" class="Symbol">}</a>
                           <a id="1928" class="Symbol">(</a><a id="1929" href="GUI.GUIFeaturesMonadicPaper.html#1929" class="Bound">machine</a> <a id="1937" class="Symbol">:</a> <a id="1939" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="1961" href="GUI.GUIFeaturesMonadicPaper.html#1866" class="Bound">A</a> <a id="1963" href="GUI.GUIFeaturesMonadicPaper.html#1868" class="Bound">F</a> <a id="1965" href="GUI.GUIFeaturesMonadicPaper.html#1892" class="Bound">S</a><a id="1966" class="Symbol">)</a>
                           <a id="1995" class="Symbol">→</a> <a id="1997" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="2019" href="GUI.GUIFeaturesMonadicPaper.html#1870" class="Bound">A&#39;</a> <a id="2022" href="GUI.GUIFeaturesMonadicPaper.html#1868" class="Bound">F</a> <a id="2024" href="GUI.GUIFeaturesMonadicPaper.html#1892" class="Bound">S</a>
<a id="2026" href="GUI.GUIFeaturesMonadicPaper.html#1848" class="Function">mapFeatureMach</a> <a id="2041" class="Symbol">{</a><a id="2042" href="GUI.GUIFeaturesMonadicPaper.html#2042" class="Bound">A</a><a id="2043" class="Symbol">}</a> <a id="2045" class="Symbol">{</a><a id="2046" href="GUI.GUIFeaturesMonadicPaper.html#2046" class="Bound">F</a><a id="2047" class="Symbol">}</a> <a id="2049" class="Symbol">{</a><a id="2050" href="GUI.GUIFeaturesMonadicPaper.html#2050" class="Bound">A&#39;</a><a id="2052" class="Symbol">}</a> <a id="2054" href="GUI.GUIFeaturesMonadicPaper.html#2054" class="Bound">g</a> <a id="2056" class="Symbol">{</a><a id="2057" href="GUI.GUIFeaturesMonadicPaper.html#2057" class="Bound">S</a><a id="2058" class="Symbol">}</a> <a id="2060" href="GUI.GUIFeaturesMonadicPaper.html#2060" class="Bound">machine</a>  <a id="2069" href="GUI.GUIFeaturesMonadicPaper.html#2069" class="Bound">f</a> <a id="2071" href="GUI.GUIFeaturesMonadicPaper.html#2071" class="Bound">s</a> <a id="2073" class="Symbol">=</a>
     <a id="2080" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a>  <a id="2097" class="Symbol">(</a><a id="2098" href="Data.Sum.Base.html#1138" class="Function">map+</a> <a id="2103" class="Symbol">(λ</a> <a id="2106" href="GUI.GUIFeaturesMonadicPaper.html#2106" class="Bound">x</a> <a id="2108" class="Symbol">→</a> <a id="2110" href="GUI.GUIFeaturesMonadicPaper.html#2106" class="Bound">x</a><a id="2111" class="Symbol">)</a> <a id="2113" href="GUI.GUIFeaturesMonadicPaper.html#2054" class="Bound">g</a><a id="2114" class="Symbol">)</a> <a id="2116" class="Symbol">(</a><a id="2117" href="GUI.GUIFeaturesMonadicPaper.html#2060" class="Bound">machine</a> <a id="2125" href="GUI.GUIFeaturesMonadicPaper.html#2069" class="Bound">f</a> <a id="2127" href="GUI.GUIFeaturesMonadicPaper.html#2071" class="Bound">s</a><a id="2128" class="Symbol">)</a>




<a id="2134" class="Comment">-- we can combine two monadic StateMachines, where the first one</a>
<a id="2199" class="Comment">--   possibly terminates in states of the second one</a>
<a id="2252" class="Comment">-- and the second one possibly terminates in states of the first one:</a>

<a id="combineStateMachineMonadic"></a><a id="2323" href="GUI.GUIFeaturesMonadicPaper.html#2323" class="Function">combineStateMachineMonadic</a> <a id="2350" class="Symbol">:</a> <a id="2352" class="Symbol">{</a><a id="2353" href="GUI.GUIFeaturesMonadicPaper.html#2353" class="Bound">S</a> <a id="2355" href="GUI.GUIFeaturesMonadicPaper.html#2355" class="Bound">S&#39;</a> <a id="2358" class="Symbol">:</a> <a id="2360" class="PrimitiveType">Set</a><a id="2363" class="Symbol">}</a>
                         <a id="2390" class="Symbol">(</a><a id="2391" href="GUI.GUIFeaturesMonadicPaper.html#2391" class="Bound">machine1</a> <a id="2400" class="Symbol">:</a> <a id="2402" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="2422" href="GUI.GUIFeaturesMonadicPaper.html#2355" class="Bound">S&#39;</a> <a id="2425" href="GUI.GUIFeaturesMonadicPaper.html#2353" class="Bound">S</a><a id="2426" class="Symbol">)</a>
                         <a id="2453" class="Symbol">(</a><a id="2454" href="GUI.GUIFeaturesMonadicPaper.html#2454" class="Bound">machine2</a> <a id="2463" class="Symbol">:</a> <a id="2465" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="2485" href="GUI.GUIFeaturesMonadicPaper.html#2353" class="Bound">S</a> <a id="2487" href="GUI.GUIFeaturesMonadicPaper.html#2355" class="Bound">S&#39;</a><a id="2489" class="Symbol">)</a>
                         <a id="2516" class="Symbol">→</a> <a id="2518" href="GUI.GUIFeaturesPart2Paper.html#934" class="Function">StateMachine</a> <a id="2531" class="Symbol">(</a><a id="2532" href="GUI.GUIFeaturesMonadicPaper.html#2353" class="Bound">S</a> <a id="2534" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="2536" href="GUI.GUIFeaturesMonadicPaper.html#2355" class="Bound">S&#39;</a><a id="2538" class="Symbol">)</a>
<a id="2540" href="GUI.GUIFeaturesMonadicPaper.html#2323" class="Function">combineStateMachineMonadic</a> <a id="2567" href="GUI.GUIFeaturesMonadicPaper.html#2567" class="Bound">machine1</a> <a id="2576" href="GUI.GUIFeaturesMonadicPaper.html#2576" class="Bound">machine2</a> <a id="2585" class="Symbol">(</a><a id="2586" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="2591" href="GUI.GUIFeaturesMonadicPaper.html#2591" class="Bound">s</a><a id="2592" class="Symbol">)</a> <a id="2594" class="Symbol">=</a> <a id="2596" href="GUI.GUIFeaturesMonadicPaper.html#2567" class="Bound">machine1</a> <a id="2605" href="GUI.GUIFeaturesMonadicPaper.html#2591" class="Bound">s</a>
<a id="2607" href="GUI.GUIFeaturesMonadicPaper.html#2323" class="Function">combineStateMachineMonadic</a> <a id="2634" href="GUI.GUIFeaturesMonadicPaper.html#2634" class="Bound">machine1</a> <a id="2643" href="GUI.GUIFeaturesMonadicPaper.html#2643" class="Bound">machine2</a> <a id="2652" class="Symbol">(</a><a id="2653" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="2658" href="GUI.GUIFeaturesMonadicPaper.html#2658" class="Bound">s&#39;</a><a id="2660" class="Symbol">)</a> <a id="2662" class="Symbol">=</a> <a id="2664" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a> <a id="2680" href="Data.Sum.Base.html#1036" class="Function">swap</a> <a id="2685" class="Symbol">(</a><a id="2686" href="GUI.GUIFeaturesMonadicPaper.html#2643" class="Bound">machine2</a> <a id="2695" href="GUI.GUIFeaturesMonadicPaper.html#2658" class="Bound">s&#39;</a><a id="2697" class="Symbol">)</a>


<a id="2701" class="Comment">-- a feature machine is transformed into an S Machine</a>
<a id="2755" class="Comment">-- by having as states   F × S</a>
<a id="2786" class="Comment">-- and for state (f , s) using machine</a>
<a id="2825" class="Comment">--    fmachine f s</a>
<a id="featureMachine2StateMachine"></a><a id="2844" href="GUI.GUIFeaturesMonadicPaper.html#2844" class="Function">featureMachine2StateMachine</a> <a id="2872" class="Symbol">:</a> <a id="2874" class="Symbol">{</a><a id="2875" href="GUI.GUIFeaturesMonadicPaper.html#2875" class="Bound">F</a> <a id="2877" href="GUI.GUIFeaturesMonadicPaper.html#2877" class="Bound">S</a> <a id="2879" class="Symbol">:</a> <a id="2881" class="PrimitiveType">Set</a><a id="2884" class="Symbol">}</a>
                          <a id="2912" class="Symbol">(</a><a id="2913" href="GUI.GUIFeaturesMonadicPaper.html#2913" class="Bound">fmachine</a> <a id="2922" class="Symbol">:</a> <a id="2924" href="GUI.GUIFeaturesPart8Paper.html#5071" class="Function">FeatureMachineNaive</a> <a id="2944" href="GUI.GUIFeaturesMonadicPaper.html#2875" class="Bound">F</a> <a id="2946" href="GUI.GUIFeaturesMonadicPaper.html#2877" class="Bound">S</a><a id="2947" class="Symbol">)</a>
                          <a id="2975" class="Symbol">→</a> <a id="2977" href="GUI.GUIFeaturesPart2Paper.html#934" class="Function">StateMachine</a> <a id="2990" class="Symbol">(</a><a id="2991" href="GUI.GUIFeaturesMonadicPaper.html#2875" class="Bound">F</a> <a id="2993" href="Data.Product.html#1329" class="Function Operator">×</a> <a id="2995" href="GUI.GUIFeaturesMonadicPaper.html#2877" class="Bound">S</a><a id="2996" class="Symbol">)</a>
<a id="2998" href="GUI.GUIFeaturesMonadicPaper.html#2844" class="Function">featureMachine2StateMachine</a> <a id="3026" class="Symbol">{</a><a id="3027" href="GUI.GUIFeaturesMonadicPaper.html#3027" class="Bound">F</a><a id="3028" class="Symbol">}</a> <a id="3030" class="Symbol">{</a><a id="3031" href="GUI.GUIFeaturesMonadicPaper.html#3031" class="Bound">S</a><a id="3032" class="Symbol">}</a> <a id="3034" href="GUI.GUIFeaturesMonadicPaper.html#3034" class="Bound">fmachine</a>  <a id="3044" class="Symbol">(</a><a id="3045" href="GUI.GUIFeaturesMonadicPaper.html#3045" class="Bound">f</a> <a id="3047" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="3049" href="GUI.GUIFeaturesMonadicPaper.html#3049" class="Bound">s</a><a id="3050" class="Symbol">)</a> <a id="3052" class="Symbol">=</a>
         <a id="3063" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a> <a id="3079" class="Symbol">(λ</a> <a id="3082" href="GUI.GUIFeaturesMonadicPaper.html#3082" class="Bound">s</a> <a id="3084" class="Symbol">→</a> <a id="3086" class="Symbol">(</a><a id="3087" href="GUI.GUIFeaturesMonadicPaper.html#3045" class="Bound">f</a> <a id="3089" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="3091" href="GUI.GUIFeaturesMonadicPaper.html#3082" class="Bound">s</a><a id="3092" class="Symbol">))</a> <a id="3095" class="Symbol">(</a><a id="3096" href="GUI.GUIFeaturesMonadicPaper.html#3034" class="Bound">fmachine</a> <a id="3105" href="GUI.GUIFeaturesMonadicPaper.html#3045" class="Bound">f</a> <a id="3107" href="GUI.GUIFeaturesMonadicPaper.html#3049" class="Bound">s</a><a id="3108" class="Symbol">)</a>


<a id="3112" class="Comment">-- auxiliary functions  used in the map in the next operation</a>
<a id="featureMachineMonadic2StateMachineMonadicaux"></a><a id="3174" href="GUI.GUIFeaturesMonadicPaper.html#3174" class="Function">featureMachineMonadic2StateMachineMonadicaux</a>   <a id="3221" class="Symbol">:</a> <a id="3223" class="Symbol">{</a><a id="3224" href="GUI.GUIFeaturesMonadicPaper.html#3224" class="Bound">F</a> <a id="3226" class="Symbol">:</a> <a id="3228" class="PrimitiveType">Set</a><a id="3231" class="Symbol">}{</a><a id="3233" href="GUI.GUIFeaturesMonadicPaper.html#3233" class="Bound">S</a> <a id="3235" class="Symbol">:</a> <a id="3237" class="PrimitiveType">Set</a><a id="3240" class="Symbol">}{</a><a id="3242" href="GUI.GUIFeaturesMonadicPaper.html#3242" class="Bound">S&#39;</a> <a id="3245" class="Symbol">:</a> <a id="3247" class="PrimitiveType">Set</a><a id="3250" class="Symbol">}</a>
       <a id="3259" class="Symbol">(</a><a id="3260" href="GUI.GUIFeaturesMonadicPaper.html#3260" class="Bound">f</a> <a id="3262" class="Symbol">:</a> <a id="3264" href="GUI.GUIFeaturesMonadicPaper.html#3224" class="Bound">F</a><a id="3265" class="Symbol">)</a>
       <a id="3274" class="Symbol">(</a><a id="3275" href="GUI.GUIFeaturesMonadicPaper.html#3275" class="Bound">ss&#39;</a> <a id="3279" class="Symbol">:</a> <a id="3281" href="GUI.GUIFeaturesMonadicPaper.html#3233" class="Bound">S</a> <a id="3283" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="3285" href="GUI.GUIFeaturesMonadicPaper.html#3242" class="Bound">S&#39;</a><a id="3287" class="Symbol">)</a>
       <a id="3296" class="Symbol">→</a> <a id="3298" href="GUI.GUIFeaturesMonadicPaper.html#3224" class="Bound">F</a> <a id="3300" href="Data.Product.html#1329" class="Function Operator">×</a> <a id="3302" href="GUI.GUIFeaturesMonadicPaper.html#3233" class="Bound">S</a> <a id="3304" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="3306" href="GUI.GUIFeaturesMonadicPaper.html#3242" class="Bound">S&#39;</a>  <a id="3310" class="Comment">-- Σ[ f ∈ F ](S f) ⊎ S&#39;</a>
<a id="3334" href="GUI.GUIFeaturesMonadicPaper.html#3174" class="Function">featureMachineMonadic2StateMachineMonadicaux</a> <a id="3379" class="Symbol">{</a><a id="3380" href="GUI.GUIFeaturesMonadicPaper.html#3380" class="Bound">F</a><a id="3381" class="Symbol">}</a> <a id="3383" class="Symbol">{</a><a id="3384" href="GUI.GUIFeaturesMonadicPaper.html#3384" class="Bound">S</a><a id="3385" class="Symbol">}</a> <a id="3387" class="Symbol">{</a><a id="3388" href="GUI.GUIFeaturesMonadicPaper.html#3388" class="Bound">S&#39;</a><a id="3390" class="Symbol">}</a> <a id="3392" href="GUI.GUIFeaturesMonadicPaper.html#3392" class="Bound">f</a> <a id="3394" class="Symbol">(</a><a id="3395" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="3400" href="GUI.GUIFeaturesMonadicPaper.html#3400" class="Bound">s</a><a id="3401" class="Symbol">)</a>
   <a id="3406" class="Symbol">=</a> <a id="3408" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="3413" class="Symbol">(</a><a id="3414" href="GUI.GUIFeaturesMonadicPaper.html#3392" class="Bound">f</a> <a id="3416" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="3418" href="GUI.GUIFeaturesMonadicPaper.html#3400" class="Bound">s</a><a id="3419" class="Symbol">)</a>
<a id="3421" href="GUI.GUIFeaturesMonadicPaper.html#3174" class="Function">featureMachineMonadic2StateMachineMonadicaux</a> <a id="3466" class="Symbol">{</a><a id="3467" href="GUI.GUIFeaturesMonadicPaper.html#3467" class="Bound">F</a><a id="3468" class="Symbol">}</a> <a id="3470" class="Symbol">{</a><a id="3471" href="GUI.GUIFeaturesMonadicPaper.html#3471" class="Bound">S</a><a id="3472" class="Symbol">}</a> <a id="3474" class="Symbol">{</a><a id="3475" href="GUI.GUIFeaturesMonadicPaper.html#3475" class="Bound">S&#39;</a><a id="3477" class="Symbol">}</a> <a id="3479" href="GUI.GUIFeaturesMonadicPaper.html#3479" class="Bound">f</a> <a id="3481" class="Symbol">(</a><a id="3482" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="3487" href="GUI.GUIFeaturesMonadicPaper.html#3487" class="Bound">s&#39;</a><a id="3489" class="Symbol">)</a>
  <a id="3493" class="Symbol">=</a> <a id="3495" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="3500" href="GUI.GUIFeaturesMonadicPaper.html#3487" class="Bound">s&#39;</a>

<a id="3504" class="Comment">-- take a monadic F machine with rerturn values in S&#39;</a>
<a id="3558" class="Comment">-- into a monadic S machine with rerturn values in S&#39;</a>
<a id="featureMachineMonadic2StateMachineMonadic"></a><a id="3612" href="GUI.GUIFeaturesMonadicPaper.html#3612" class="Function">featureMachineMonadic2StateMachineMonadic</a> <a id="3654" class="Symbol">:</a> <a id="3656" class="Symbol">{</a><a id="3657" href="GUI.GUIFeaturesMonadicPaper.html#3657" class="Bound">F</a> <a id="3659" class="Symbol">:</a> <a id="3661" class="PrimitiveType">Set</a><a id="3664" class="Symbol">}{</a><a id="3666" href="GUI.GUIFeaturesMonadicPaper.html#3666" class="Bound">S</a> <a id="3668" class="Symbol">:</a> <a id="3670" class="PrimitiveType">Set</a><a id="3673" class="Symbol">}{</a><a id="3675" href="GUI.GUIFeaturesMonadicPaper.html#3675" class="Bound">S&#39;</a> <a id="3678" class="Symbol">:</a> <a id="3680" class="PrimitiveType">Set</a><a id="3683" class="Symbol">}</a>
                          <a id="3711" class="Symbol">(</a><a id="3712" href="GUI.GUIFeaturesMonadicPaper.html#3712" class="Bound">fmachine</a> <a id="3721" class="Symbol">:</a> <a id="3723" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a>  <a id="3746" href="GUI.GUIFeaturesMonadicPaper.html#3675" class="Bound">S&#39;</a> <a id="3749" href="GUI.GUIFeaturesMonadicPaper.html#3657" class="Bound">F</a> <a id="3751" href="GUI.GUIFeaturesMonadicPaper.html#3666" class="Bound">S</a><a id="3752" class="Symbol">)</a>
                          <a id="3780" class="Symbol">→</a> <a id="3782" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="3802" href="GUI.GUIFeaturesMonadicPaper.html#3675" class="Bound">S&#39;</a> <a id="3805" class="Symbol">(</a><a id="3806" href="GUI.GUIFeaturesMonadicPaper.html#3657" class="Bound">F</a> <a id="3808" href="Data.Product.html#1329" class="Function Operator">×</a>  <a id="3811" href="GUI.GUIFeaturesMonadicPaper.html#3666" class="Bound">S</a><a id="3812" class="Symbol">)</a>
<a id="3814" href="GUI.GUIFeaturesMonadicPaper.html#3612" class="Function">featureMachineMonadic2StateMachineMonadic</a> <a id="3856" class="Symbol">{</a><a id="3857" href="GUI.GUIFeaturesMonadicPaper.html#3857" class="Bound">F</a><a id="3858" class="Symbol">}</a> <a id="3860" class="Symbol">{</a><a id="3861" href="GUI.GUIFeaturesMonadicPaper.html#3861" class="Bound">S</a><a id="3862" class="Symbol">}</a> <a id="3864" class="Symbol">{</a><a id="3865" href="GUI.GUIFeaturesMonadicPaper.html#3865" class="Bound">S&#39;</a><a id="3867" class="Symbol">}</a> <a id="3869" href="GUI.GUIFeaturesMonadicPaper.html#3869" class="Bound">fmachine</a> <a id="3878" class="Symbol">(</a><a id="3879" href="GUI.GUIFeaturesMonadicPaper.html#3879" class="Bound">f</a> <a id="3881" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="3883" href="GUI.GUIFeaturesMonadicPaper.html#3883" class="Bound">s</a><a id="3884" class="Symbol">)</a>
     <a id="3891" class="Symbol">=</a> <a id="3893" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a> <a id="3909" class="Symbol">(</a><a id="3910" href="GUI.GUIFeaturesMonadicPaper.html#3174" class="Function">featureMachineMonadic2StateMachineMonadicaux</a> <a id="3955" href="GUI.GUIFeaturesMonadicPaper.html#3879" class="Bound">f</a><a id="3956" class="Symbol">)</a> <a id="3958" class="Symbol">(</a><a id="3959" href="GUI.GUIFeaturesMonadicPaper.html#3869" class="Bound">fmachine</a> <a id="3968" href="GUI.GUIFeaturesMonadicPaper.html#3879" class="Bound">f</a> <a id="3970" href="GUI.GUIFeaturesMonadicPaper.html#3883" class="Bound">s</a><a id="3971" class="Symbol">)</a>

<a id="combineStateFeatureMachineaux"></a><a id="3974" href="GUI.GUIFeaturesMonadicPaper.html#3974" class="Function">combineStateFeatureMachineaux</a> <a id="4004" class="Symbol">:</a> <a id="4006" class="Symbol">{</a><a id="4007" href="GUI.GUIFeaturesMonadicPaper.html#4007" class="Bound">F</a> <a id="4009" href="GUI.GUIFeaturesMonadicPaper.html#4009" class="Bound">S</a> <a id="4011" class="Symbol">:</a> <a id="4013" class="PrimitiveType">Set</a><a id="4016" class="Symbol">}{</a><a id="4018" href="GUI.GUIFeaturesMonadicPaper.html#4018" class="Bound">S&#39;</a> <a id="4021" class="Symbol">:</a> <a id="4023" class="PrimitiveType">Set</a><a id="4026" class="Symbol">}</a>
                                    <a id="4064" class="Symbol">(</a><a id="4065" href="GUI.GUIFeaturesMonadicPaper.html#4065" class="Bound">f</a> <a id="4067" class="Symbol">:</a> <a id="4069" href="GUI.GUIFeaturesMonadicPaper.html#4007" class="Bound">F</a><a id="4070" class="Symbol">)</a>
                                    <a id="4108" class="Symbol">(</a><a id="4109" href="GUI.GUIFeaturesMonadicPaper.html#4109" class="Bound">s&#39;s</a> <a id="4113" class="Symbol">:</a> <a id="4115" href="GUI.GUIFeaturesMonadicPaper.html#4018" class="Bound">S&#39;</a> <a id="4118" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="4120" href="GUI.GUIFeaturesMonadicPaper.html#4009" class="Bound">S</a><a id="4121" class="Symbol">)</a>
                                    <a id="4159" class="Symbol">→</a> <a id="4161" href="GUI.GUIFeaturesMonadicPaper.html#4009" class="Bound">S</a> <a id="4163" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="4165" class="Symbol">(</a><a id="4166" href="GUI.GUIFeaturesMonadicPaper.html#4007" class="Bound">F</a> <a id="4168" href="Data.Product.html#1329" class="Function Operator">×</a>  <a id="4171" href="GUI.GUIFeaturesMonadicPaper.html#4018" class="Bound">S&#39;</a><a id="4173" class="Symbol">)</a>
<a id="4175" href="GUI.GUIFeaturesMonadicPaper.html#3974" class="Function">combineStateFeatureMachineaux</a> <a id="4205" class="Symbol">{</a><a id="4206" href="GUI.GUIFeaturesMonadicPaper.html#4206" class="Bound">F</a><a id="4207" class="Symbol">}</a> <a id="4209" class="Symbol">{</a><a id="4210" href="GUI.GUIFeaturesMonadicPaper.html#4210" class="Bound">S</a><a id="4211" class="Symbol">}</a> <a id="4213" class="Symbol">{</a><a id="4214" href="GUI.GUIFeaturesMonadicPaper.html#4214" class="Bound">S&#39;</a><a id="4216" class="Symbol">}</a> <a id="4218" href="GUI.GUIFeaturesMonadicPaper.html#4218" class="Bound">f</a> <a id="4220" class="Symbol">(</a><a id="4221" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="4226" href="GUI.GUIFeaturesMonadicPaper.html#4226" class="Bound">s&#39;</a><a id="4228" class="Symbol">)</a> <a id="4230" class="Symbol">=</a> <a id="4232" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="4237" class="Symbol">(</a><a id="4238" href="GUI.GUIFeaturesMonadicPaper.html#4218" class="Bound">f</a> <a id="4240" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="4242" href="GUI.GUIFeaturesMonadicPaper.html#4226" class="Bound">s&#39;</a><a id="4244" class="Symbol">)</a>
<a id="4246" href="GUI.GUIFeaturesMonadicPaper.html#3974" class="Function">combineStateFeatureMachineaux</a> <a id="4276" class="Symbol">{</a><a id="4277" href="GUI.GUIFeaturesMonadicPaper.html#4277" class="Bound">F</a><a id="4278" class="Symbol">}</a> <a id="4280" class="Symbol">{</a><a id="4281" href="GUI.GUIFeaturesMonadicPaper.html#4281" class="Bound">S</a><a id="4282" class="Symbol">}</a> <a id="4284" class="Symbol">{</a><a id="4285" href="GUI.GUIFeaturesMonadicPaper.html#4285" class="Bound">S&#39;</a><a id="4287" class="Symbol">}</a> <a id="4289" href="GUI.GUIFeaturesMonadicPaper.html#4289" class="Bound">f</a> <a id="4291" class="Symbol">(</a><a id="4292" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="4297" href="GUI.GUIFeaturesMonadicPaper.html#4297" class="Bound">s</a><a id="4298" class="Symbol">)</a> <a id="4300" class="Symbol">=</a> <a id="4302" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="4307" href="GUI.GUIFeaturesMonadicPaper.html#4297" class="Bound">s</a>

<a id="4310" class="Comment">-- we combine one monadic S machine with return values in</a>
<a id="4368" class="Comment">--  a feature and state of a second machine</a>
<a id="4412" class="Comment">-- with a monadic feature machine  with return values</a>
<a id="4466" class="Comment">-- into the states of the first machine</a>

<a id="4507" class="Comment">-- \GUIFeaturesMonadicPaper</a>
<a id="combineStateFeatureMachine"></a><a id="4535" href="GUI.GUIFeaturesMonadicPaper.html#4535" class="Function">combineStateFeatureMachine</a> <a id="4562" class="Symbol">:</a> <a id="4564" class="Symbol">{</a><a id="4565" href="GUI.GUIFeaturesMonadicPaper.html#4565" class="Bound">F</a> <a id="4567" href="GUI.GUIFeaturesMonadicPaper.html#4567" class="Bound">S</a> <a id="4569" href="GUI.GUIFeaturesMonadicPaper.html#4569" class="Bound">S&#39;</a> <a id="4572" class="Symbol">:</a> <a id="4574" class="PrimitiveType">Set</a><a id="4577" class="Symbol">}</a>
                         <a id="4604" class="Symbol">(</a><a id="4605" href="GUI.GUIFeaturesMonadicPaper.html#4605" class="Bound">machine₁</a> <a id="4614" class="Symbol">:</a> <a id="4616" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="4636" class="Symbol">(</a><a id="4637" href="GUI.GUIFeaturesMonadicPaper.html#4565" class="Bound">F</a> <a id="4639" href="Data.Product.html#1329" class="Function Operator">×</a>  <a id="4642" href="GUI.GUIFeaturesMonadicPaper.html#4569" class="Bound">S&#39;</a><a id="4644" class="Symbol">)</a> <a id="4646" href="GUI.GUIFeaturesMonadicPaper.html#4567" class="Bound">S</a><a id="4647" class="Symbol">)</a>
                         <a id="4674" class="Symbol">(</a><a id="4675" href="GUI.GUIFeaturesMonadicPaper.html#4675" class="Bound">machine₂</a> <a id="4684" class="Symbol">:</a> <a id="4686" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="4708" href="GUI.GUIFeaturesMonadicPaper.html#4567" class="Bound">S</a> <a id="4710" href="GUI.GUIFeaturesMonadicPaper.html#4565" class="Bound">F</a> <a id="4712" href="GUI.GUIFeaturesMonadicPaper.html#4569" class="Bound">S&#39;</a><a id="4714" class="Symbol">)</a>
                         <a id="4741" class="Symbol">→</a> <a id="4743" href="GUI.GUIFeaturesPart2Paper.html#934" class="Function">StateMachine</a> <a id="4756" class="Symbol">(</a><a id="4757" href="GUI.GUIFeaturesMonadicPaper.html#4567" class="Bound">S</a> <a id="4759" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="4761" class="Symbol">(</a><a id="4762" href="GUI.GUIFeaturesMonadicPaper.html#4565" class="Bound">F</a> <a id="4764" href="Data.Product.html#1329" class="Function Operator">×</a>  <a id="4767" href="GUI.GUIFeaturesMonadicPaper.html#4569" class="Bound">S&#39;</a><a id="4769" class="Symbol">))</a>
<a id="4772" href="GUI.GUIFeaturesMonadicPaper.html#4535" class="Function">combineStateFeatureMachine</a> <a id="4799" class="Symbol">{</a><a id="4800" href="GUI.GUIFeaturesMonadicPaper.html#4800" class="Bound">F</a><a id="4801" class="Symbol">}</a> <a id="4803" class="Symbol">{</a><a id="4804" href="GUI.GUIFeaturesMonadicPaper.html#4804" class="Bound">S</a><a id="4805" class="Symbol">}</a> <a id="4807" class="Symbol">{</a><a id="4808" href="GUI.GUIFeaturesMonadicPaper.html#4808" class="Bound">S&#39;</a><a id="4810" class="Symbol">}</a> <a id="4812" href="GUI.GUIFeaturesMonadicPaper.html#4812" class="Bound">machine₁</a> <a id="4821" href="GUI.GUIFeaturesMonadicPaper.html#4821" class="Bound">machine₂</a> <a id="4830" class="Symbol">(</a><a id="4831" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="4836" href="GUI.GUIFeaturesMonadicPaper.html#4836" class="Bound">s</a><a id="4837" class="Symbol">)</a> <a id="4839" class="Symbol">=</a> <a id="4841" href="GUI.GUIFeaturesMonadicPaper.html#4812" class="Bound">machine₁</a> <a id="4850" href="GUI.GUIFeaturesMonadicPaper.html#4836" class="Bound">s</a>
<a id="4852" href="GUI.GUIFeaturesMonadicPaper.html#4535" class="Function">combineStateFeatureMachine</a> <a id="4879" class="Symbol">{</a><a id="4880" href="GUI.GUIFeaturesMonadicPaper.html#4880" class="Bound">F</a><a id="4881" class="Symbol">}</a> <a id="4883" class="Symbol">{</a><a id="4884" href="GUI.GUIFeaturesMonadicPaper.html#4884" class="Bound">S</a><a id="4885" class="Symbol">}</a> <a id="4887" class="Symbol">{</a><a id="4888" href="GUI.GUIFeaturesMonadicPaper.html#4888" class="Bound">S&#39;</a><a id="4890" class="Symbol">}</a> <a id="4892" href="GUI.GUIFeaturesMonadicPaper.html#4892" class="Bound">machine₁</a> <a id="4901" href="GUI.GUIFeaturesMonadicPaper.html#4901" class="Bound">machine₂</a> <a id="4910" class="Symbol">(</a><a id="4911" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="4916" class="Symbol">(</a><a id="4917" href="GUI.GUIFeaturesMonadicPaper.html#4917" class="Bound">f</a> <a id="4919" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="4921" href="GUI.GUIFeaturesMonadicPaper.html#4921" class="Bound">s&#39;</a><a id="4923" class="Symbol">))</a> <a id="4926" class="Symbol">=</a>
   <a id="4931" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a>  <a id="4948" class="Symbol">(</a><a id="4949" href="GUI.GUIFeaturesMonadicPaper.html#3974" class="Function">combineStateFeatureMachineaux</a> <a id="4979" href="GUI.GUIFeaturesMonadicPaper.html#4917" class="Bound">f</a><a id="4980" class="Symbol">)</a> <a id="4982" class="Symbol">(</a><a id="4983" href="GUI.GUIFeaturesMonadicPaper.html#4901" class="Bound">machine₂</a> <a id="4992" href="GUI.GUIFeaturesMonadicPaper.html#4917" class="Bound">f</a> <a id="4994" href="GUI.GUIFeaturesMonadicPaper.html#4921" class="Bound">s&#39;</a><a id="4996" class="Symbol">)</a>

<a id="mapStateMachineHandlMonadic"></a><a id="4999" href="GUI.GUIFeaturesMonadicPaper.html#4999" class="Function">mapStateMachineHandlMonadic</a> <a id="5027" class="Symbol">:</a> <a id="5029" class="Symbol">{</a><a id="5030" href="GUI.GUIFeaturesMonadicPaper.html#5030" class="Bound">A</a> <a id="5032" href="GUI.GUIFeaturesMonadicPaper.html#5032" class="Bound">S</a> <a id="5034" href="GUI.GUIFeaturesMonadicPaper.html#5034" class="Bound">S&#39;</a> <a id="5037" class="Symbol">:</a> <a id="5039" class="PrimitiveType">Set</a><a id="5042" class="Symbol">}(</a><a id="5044" href="GUI.GUIFeaturesMonadicPaper.html#5044" class="Bound">f</a> <a id="5046" class="Symbol">:</a> <a id="5048" href="GUI.GUIFeaturesMonadicPaper.html#5032" class="Bound">S</a> <a id="5050" class="Symbol">→</a> <a id="5052" href="GUI.GUIFeaturesMonadicPaper.html#5034" class="Bound">S&#39;</a><a id="5054" class="Symbol">)</a>
                       <a id="5079" class="Symbol">(</a><a id="5080" href="GUI.GUIFeaturesMonadicPaper.html#5080" class="Bound">p</a> <a id="5082" class="Symbol">:</a> <a id="5084" href="SizedIO.Base.html#681" class="Datatype">IO</a> <a id="5087" href="SizedIO.Console.html#360" class="Function">consoleI</a> <a id="5096" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a> <a id="5098" class="Symbol">(</a><a id="5099" href="GUI.GUIFeaturesMonadicPaper.html#5032" class="Bound">S</a> <a id="5101" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="5103" href="GUI.GUIFeaturesMonadicPaper.html#5030" class="Bound">A</a><a id="5104" class="Symbol">))</a>
                       <a id="5130" class="Symbol">→</a> <a id="5132" href="SizedIO.Base.html#681" class="Datatype">IO</a> <a id="5135" href="SizedIO.Console.html#360" class="Function">consoleI</a> <a id="5144" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a> <a id="5146" class="Symbol">(</a><a id="5147" href="GUI.GUIFeaturesMonadicPaper.html#5034" class="Bound">S&#39;</a> <a id="5150" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="5152" href="GUI.GUIFeaturesMonadicPaper.html#5030" class="Bound">A</a><a id="5153" class="Symbol">)</a>
<a id="5155" href="GUI.GUIFeaturesMonadicPaper.html#4999" class="Function">mapStateMachineHandlMonadic</a> <a id="5183" href="GUI.GUIFeaturesMonadicPaper.html#5183" class="Bound">f</a> <a id="5185" href="GUI.GUIFeaturesMonadicPaper.html#5185" class="Bound">p</a> <a id="5187" class="Symbol">=</a> <a id="5189" href="SizedIO.Base.html#3836" class="Function">mapIO&#39;</a> <a id="5196" class="Symbol">(</a><a id="5197" href="Data.Sum.Base.html#1138" class="Function">map+</a> <a id="5202" href="GUI.GUIFeaturesMonadicPaper.html#5183" class="Bound">f</a> <a id="5204" class="Symbol">λ</a> <a id="5206" href="GUI.GUIFeaturesMonadicPaper.html#5206" class="Bound">a</a> <a id="5208" class="Symbol">→</a> <a id="5210" href="GUI.GUIFeaturesMonadicPaper.html#5206" class="Bound">a</a> <a id="5212" class="Symbol">)</a> <a id="5214" href="GUI.GUIFeaturesMonadicPaper.html#5185" class="Bound">p</a>

<a id="extendStateMachineMonadic"></a><a id="5217" href="GUI.GUIFeaturesMonadicPaper.html#5217" class="Function">extendStateMachineMonadic</a> <a id="5243" class="Symbol">:</a> <a id="5245" class="Symbol">{</a><a id="5246" href="GUI.GUIFeaturesMonadicPaper.html#5246" class="Bound">A</a> <a id="5248" href="GUI.GUIFeaturesMonadicPaper.html#5248" class="Bound">S</a> <a id="5250" href="GUI.GUIFeaturesMonadicPaper.html#5250" class="Bound">S&#39;</a> <a id="5253" class="Symbol">:</a> <a id="5255" class="PrimitiveType">Set</a><a id="5258" class="Symbol">}</a> <a id="5260" class="Symbol">(</a><a id="5261" href="GUI.GUIFeaturesMonadicPaper.html#5261" class="Bound">sm</a> <a id="5264" class="Symbol">:</a> <a id="5266" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="5286" href="GUI.GUIFeaturesMonadicPaper.html#5246" class="Bound">A</a> <a id="5288" href="GUI.GUIFeaturesMonadicPaper.html#5248" class="Bound">S</a><a id="5289" class="Symbol">)</a>
                              <a id="5321" class="Symbol">(</a><a id="5322" href="GUI.GUIFeaturesMonadicPaper.html#5322" class="Bound">new</a> <a id="5326" class="Symbol">:</a> <a id="5328" class="Symbol">(</a><a id="5329" href="GUI.GUIFeaturesMonadicPaper.html#5329" class="Bound">s&#39;</a> <a id="5332" class="Symbol">:</a> <a id="5334" href="GUI.GUIFeaturesMonadicPaper.html#5250" class="Bound">S&#39;</a><a id="5336" class="Symbol">)</a>
                                     <a id="5375" class="Symbol">→</a> <a id="5377" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="5390" class="Symbol">((</a><a id="5392" href="GUI.GUIFeaturesMonadicPaper.html#5248" class="Bound">S</a> <a id="5394" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="5396" href="GUI.GUIFeaturesMonadicPaper.html#5250" class="Bound">S&#39;</a><a id="5398" class="Symbol">)</a> <a id="5400" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="5402" href="GUI.GUIFeaturesMonadicPaper.html#5246" class="Bound">A</a><a id="5403" class="Symbol">)</a> <a id="5405" class="Comment">{-(inj₂ s&#39;)-}</a><a id="5418" class="Symbol">)</a>
                 <a id="5437" class="Symbol">→</a> <a id="5439" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="5459" href="GUI.GUIFeaturesMonadicPaper.html#5246" class="Bound">A</a> <a id="5461" class="Symbol">(</a><a id="5462" href="GUI.GUIFeaturesMonadicPaper.html#5248" class="Bound">S</a> <a id="5464" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="5466" href="GUI.GUIFeaturesMonadicPaper.html#5250" class="Bound">S&#39;</a><a id="5468" class="Symbol">)</a>
<a id="5470" href="GUI.GUIFeaturesMonadicPaper.html#5217" class="Function">extendStateMachineMonadic</a>  <a id="5497" href="GUI.GUIFeaturesMonadicPaper.html#5497" class="Bound">sm</a> <a id="5500" href="GUI.GUIFeaturesMonadicPaper.html#5500" class="Bound">new</a> <a id="5504" class="Symbol">(</a><a id="5505" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="5510" href="GUI.GUIFeaturesMonadicPaper.html#5510" class="Bound">s</a><a id="5511" class="Symbol">)</a> <a id="5513" class="Symbol">.</a><a id="5514" href="GUI.GUIFeaturesPart2Paper.html#864" class="Field">view</a> <a id="5519" class="Symbol">=</a> <a id="5521" href="GUI.GUIFeaturesMonadicPaper.html#5497" class="Bound">sm</a> <a id="5524" href="GUI.GUIFeaturesMonadicPaper.html#5510" class="Bound">s</a> <a id="5526" class="Symbol">.</a><a id="5527" href="GUI.GUIFeaturesPart2Paper.html#864" class="Field">view</a>
<a id="5532" href="GUI.GUIFeaturesMonadicPaper.html#5217" class="Function">extendStateMachineMonadic</a>  <a id="5559" href="GUI.GUIFeaturesMonadicPaper.html#5559" class="Bound">sm</a> <a id="5562" href="GUI.GUIFeaturesMonadicPaper.html#5562" class="Bound">new</a> <a id="5566" class="Symbol">(</a><a id="5567" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="5572" href="GUI.GUIFeaturesMonadicPaper.html#5572" class="Bound">s</a><a id="5573" class="Symbol">)</a> <a id="5575" class="Symbol">.</a><a id="5576" href="GUI.GUIFeaturesPart2Paper.html#883" class="Field">handleUserInput</a> <a id="5592" href="GUI.GUIFeaturesMonadicPaper.html#5592" class="Bound">m</a> <a id="5594" class="Symbol">=</a> <a id="5596" href="GUI.GUIFeaturesMonadicPaper.html#4999" class="Function">mapStateMachineHandlMonadic</a> <a id="5624" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="5629" class="Symbol">(</a><a id="5630" href="GUI.GUIFeaturesMonadicPaper.html#5559" class="Bound">sm</a> <a id="5633" href="GUI.GUIFeaturesMonadicPaper.html#5572" class="Bound">s</a> <a id="5635" class="Symbol">.</a><a id="5636" href="GUI.GUIFeaturesPart2Paper.html#883" class="Field">handleUserInput</a> <a id="5652" href="GUI.GUIFeaturesMonadicPaper.html#5592" class="Bound">m</a><a id="5653" class="Symbol">)</a>
<a id="5655" href="GUI.GUIFeaturesMonadicPaper.html#5217" class="Function">extendStateMachineMonadic</a>  <a id="5682" href="GUI.GUIFeaturesMonadicPaper.html#5682" class="Bound">sm</a> <a id="5685" href="GUI.GUIFeaturesMonadicPaper.html#5685" class="Bound">new</a> <a id="5689" class="Symbol">(</a><a id="5690" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="5695" href="GUI.GUIFeaturesMonadicPaper.html#5695" class="Bound">s&#39;</a><a id="5697" class="Symbol">)</a> <a id="5699" class="Symbol">=</a> <a id="5701" href="GUI.GUIFeaturesMonadicPaper.html#5685" class="Bound">new</a> <a id="5705" href="GUI.GUIFeaturesMonadicPaper.html#5695" class="Bound">s&#39;</a>



<a id="adaptStateMachineStateMonadic"></a><a id="5711" href="GUI.GUIFeaturesMonadicPaper.html#5711" class="Function">adaptStateMachineStateMonadic</a> <a id="5741" class="Symbol">:</a> <a id="5743" class="Symbol">{</a><a id="5744" href="GUI.GUIFeaturesMonadicPaper.html#5744" class="Bound">A</a> <a id="5746" href="GUI.GUIFeaturesMonadicPaper.html#5746" class="Bound">S</a> <a id="5748" href="GUI.GUIFeaturesMonadicPaper.html#5748" class="Bound">S&#39;</a> <a id="5751" class="Symbol">:</a> <a id="5753" class="PrimitiveType">Set</a><a id="5756" class="Symbol">}(</a><a id="5758" href="GUI.GUIFeaturesMonadicPaper.html#5758" class="Bound">ss&#39;</a> <a id="5762" class="Symbol">:</a> <a id="5764" href="GUI.GUIFeaturesMonadicPaper.html#5746" class="Bound">S</a> <a id="5766" class="Symbol">→</a> <a id="5768" href="GUI.GUIFeaturesMonadicPaper.html#5748" class="Bound">S&#39;</a><a id="5770" class="Symbol">)</a><a id="5771" class="Comment">{-(s : S)(s&#39; : S&#39;)-}</a>
                     <a id="5813" class="Symbol">(</a><a id="5814" href="GUI.GUIFeaturesMonadicPaper.html#5814" class="Bound">smState</a> <a id="5822" class="Symbol">:</a> <a id="5824" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="5837" class="Symbol">(</a><a id="5838" href="GUI.GUIFeaturesMonadicPaper.html#5746" class="Bound">S</a> <a id="5840" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="5842" href="GUI.GUIFeaturesMonadicPaper.html#5744" class="Bound">A</a><a id="5843" class="Symbol">)</a> <a id="5845" class="Comment">{-s-}</a><a id="5850" class="Symbol">)</a>
                     <a id="5873" class="Symbol">→</a> <a id="5875" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="5888" class="Symbol">(</a><a id="5889" href="GUI.GUIFeaturesMonadicPaper.html#5748" class="Bound">S&#39;</a> <a id="5892" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="5894" href="GUI.GUIFeaturesMonadicPaper.html#5744" class="Bound">A</a><a id="5895" class="Symbol">)</a> <a id="5897" class="Comment">{-s&#39;-}</a>
<a id="5904" href="GUI.GUIFeaturesMonadicPaper.html#5711" class="Function">adaptStateMachineStateMonadic</a> <a id="5934" href="GUI.GUIFeaturesMonadicPaper.html#5934" class="Bound">ss&#39;</a> <a id="5938" class="Comment">{-s s&#39;-}</a> <a id="5947" href="GUI.GUIFeaturesMonadicPaper.html#5947" class="Bound">smState</a> <a id="5955" class="Symbol">.</a><a id="5956" href="GUI.GUIFeaturesPart2Paper.html#864" class="Field">view</a>  <a id="5962" class="Symbol">=</a> <a id="5964" href="GUI.GUIFeaturesMonadicPaper.html#5947" class="Bound">smState</a> <a id="5972" class="Symbol">.</a><a id="5973" href="GUI.GUIFeaturesPart2Paper.html#864" class="Field">view</a>
<a id="5978" href="GUI.GUIFeaturesMonadicPaper.html#5711" class="Function">adaptStateMachineStateMonadic</a> <a id="6008" href="GUI.GUIFeaturesMonadicPaper.html#6008" class="Bound">ss&#39;</a> <a id="6012" class="Comment">{-s s&#39;-}</a> <a id="6021" href="GUI.GUIFeaturesMonadicPaper.html#6021" class="Bound">smState</a> <a id="6029" class="Symbol">.</a><a id="6030" href="GUI.GUIFeaturesPart2Paper.html#883" class="Field">handleUserInput</a> <a id="6046" href="GUI.GUIFeaturesMonadicPaper.html#6046" class="Bound">m</a> <a id="6048" class="Symbol">=</a> <a id="6050" href="GUI.GUIFeaturesMonadicPaper.html#4999" class="Function">mapStateMachineHandlMonadic</a> <a id="6078" href="GUI.GUIFeaturesMonadicPaper.html#6008" class="Bound">ss&#39;</a> <a id="6082" class="Symbol">(</a><a id="6083" href="GUI.GUIFeaturesMonadicPaper.html#6021" class="Bound">smState</a> <a id="6091" class="Symbol">.</a><a id="6092" href="GUI.GUIFeaturesPart2Paper.html#883" class="Field">handleUserInput</a> <a id="6108" href="GUI.GUIFeaturesMonadicPaper.html#6046" class="Bound">m</a><a id="6109" class="Symbol">)</a>


<a id="adaptStateMachineMonadic"></a><a id="6113" href="GUI.GUIFeaturesMonadicPaper.html#6113" class="Function">adaptStateMachineMonadic</a> <a id="6138" class="Symbol">:</a> <a id="6140" class="Symbol">{</a><a id="6141" href="GUI.GUIFeaturesMonadicPaper.html#6141" class="Bound">A</a> <a id="6143" href="GUI.GUIFeaturesMonadicPaper.html#6143" class="Bound">S</a> <a id="6145" href="GUI.GUIFeaturesMonadicPaper.html#6145" class="Bound">S&#39;</a> <a id="6148" class="Symbol">:</a> <a id="6150" class="PrimitiveType">Set</a><a id="6153" class="Symbol">}(</a><a id="6155" href="GUI.GUIFeaturesMonadicPaper.html#6155" class="Bound">ss&#39;</a> <a id="6159" class="Symbol">:</a> <a id="6161" href="GUI.GUIFeaturesMonadicPaper.html#6143" class="Bound">S</a> <a id="6163" class="Symbol">→</a> <a id="6165" href="GUI.GUIFeaturesMonadicPaper.html#6145" class="Bound">S&#39;</a><a id="6167" class="Symbol">)(</a><a id="6169" href="GUI.GUIFeaturesMonadicPaper.html#6169" class="Bound">s&#39;s</a> <a id="6173" class="Symbol">:</a> <a id="6175" href="GUI.GUIFeaturesMonadicPaper.html#6145" class="Bound">S&#39;</a> <a id="6178" class="Symbol">→</a> <a id="6180" href="GUI.GUIFeaturesMonadicPaper.html#6143" class="Bound">S</a><a id="6181" class="Symbol">)</a>
                <a id="6199" class="Symbol">(</a><a id="6200" href="GUI.GUIFeaturesMonadicPaper.html#6200" class="Bound">sm</a> <a id="6203" class="Symbol">:</a> <a id="6205" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a>  <a id="6226" href="GUI.GUIFeaturesMonadicPaper.html#6141" class="Bound">A</a> <a id="6228" href="GUI.GUIFeaturesMonadicPaper.html#6143" class="Bound">S</a><a id="6229" class="Symbol">)</a>
                <a id="6247" class="Symbol">→</a> <a id="6249" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="6269" href="GUI.GUIFeaturesMonadicPaper.html#6141" class="Bound">A</a> <a id="6271" href="GUI.GUIFeaturesMonadicPaper.html#6145" class="Bound">S&#39;</a>
<a id="6274" href="GUI.GUIFeaturesMonadicPaper.html#6113" class="Function">adaptStateMachineMonadic</a> <a id="6299" href="GUI.GUIFeaturesMonadicPaper.html#6299" class="Bound">ss&#39;</a> <a id="6303" href="GUI.GUIFeaturesMonadicPaper.html#6303" class="Bound">s&#39;s</a> <a id="6307" href="GUI.GUIFeaturesMonadicPaper.html#6307" class="Bound">sm</a> <a id="6310" href="GUI.GUIFeaturesMonadicPaper.html#6310" class="Bound">s&#39;</a> <a id="6313" class="Symbol">=</a> <a id="6315" href="GUI.GUIFeaturesMonadicPaper.html#5711" class="Function">adaptStateMachineStateMonadic</a> <a id="6345" href="GUI.GUIFeaturesMonadicPaper.html#6299" class="Bound">ss&#39;</a> <a id="6349" class="Comment">{-(s&#39;s s&#39;)-}</a> <a id="6362" class="Comment">{-s&#39;-}</a> <a id="6369" class="Symbol">(</a><a id="6370" href="GUI.GUIFeaturesMonadicPaper.html#6307" class="Bound">sm</a> <a id="6373" class="Symbol">(</a><a id="6374" href="GUI.GUIFeaturesMonadicPaper.html#6303" class="Bound">s&#39;s</a> <a id="6378" href="GUI.GUIFeaturesMonadicPaper.html#6310" class="Bound">s&#39;</a><a id="6380" class="Symbol">))</a>

<a id="mapS⊎[S&#39;⊎S&#39;&#39;]⊎A"></a><a id="6384" href="GUI.GUIFeaturesMonadicPaper.html#6384" class="Function">mapS⊎[S&#39;⊎S&#39;&#39;]⊎A</a> <a id="6400" class="Symbol">:</a> <a id="6402" class="Symbol">{</a><a id="6403" href="GUI.GUIFeaturesMonadicPaper.html#6403" class="Bound">A</a> <a id="6405" href="GUI.GUIFeaturesMonadicPaper.html#6405" class="Bound">S</a> <a id="6407" href="GUI.GUIFeaturesMonadicPaper.html#6407" class="Bound">S&#39;</a> <a id="6410" href="GUI.GUIFeaturesMonadicPaper.html#6410" class="Bound">S&#39;&#39;</a> <a id="6414" class="Symbol">:</a> <a id="6416" class="PrimitiveType">Set</a><a id="6419" class="Symbol">}</a>
                <a id="6437" class="Symbol">→</a> <a id="6439" class="Symbol">(</a><a id="6440" href="GUI.GUIFeaturesMonadicPaper.html#6405" class="Bound">S</a> <a id="6442" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6444" class="Symbol">(</a><a id="6445" href="GUI.GUIFeaturesMonadicPaper.html#6407" class="Bound">S&#39;</a> <a id="6448" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6450" href="GUI.GUIFeaturesMonadicPaper.html#6410" class="Bound">S&#39;&#39;</a><a id="6453" class="Symbol">))</a> <a id="6456" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6458" href="GUI.GUIFeaturesMonadicPaper.html#6403" class="Bound">A</a>
                <a id="6476" class="Symbol">→</a> <a id="6478" class="Symbol">((</a><a id="6480" href="GUI.GUIFeaturesMonadicPaper.html#6405" class="Bound">S</a> <a id="6482" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6484" href="GUI.GUIFeaturesMonadicPaper.html#6407" class="Bound">S&#39;</a><a id="6486" class="Symbol">)</a> <a id="6488" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6490" href="GUI.GUIFeaturesMonadicPaper.html#6410" class="Bound">S&#39;&#39;</a><a id="6493" class="Symbol">)</a> <a id="6495" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6497" href="GUI.GUIFeaturesMonadicPaper.html#6403" class="Bound">A</a>
<a id="6499" href="GUI.GUIFeaturesMonadicPaper.html#6384" class="Function">mapS⊎[S&#39;⊎S&#39;&#39;]⊎A</a> <a id="6515" class="Symbol">(</a><a id="6516" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6521" class="Symbol">((</a><a id="6523" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6528" href="GUI.GUIFeaturesMonadicPaper.html#6528" class="Bound">s</a><a id="6529" class="Symbol">)))</a> <a id="6533" class="Symbol">=</a> <a id="6535" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6540" class="Symbol">(</a><a id="6541" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6546" class="Symbol">(</a><a id="6547" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6552" href="GUI.GUIFeaturesMonadicPaper.html#6528" class="Bound">s</a><a id="6553" class="Symbol">))</a>
<a id="6556" href="GUI.GUIFeaturesMonadicPaper.html#6384" class="Function">mapS⊎[S&#39;⊎S&#39;&#39;]⊎A</a> <a id="6572" class="Symbol">(</a><a id="6573" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6578" class="Symbol">(</a><a id="6579" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="6584" class="Symbol">(</a><a id="6585" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6590" href="GUI.GUIFeaturesMonadicPaper.html#6590" class="Bound">s&#39;</a><a id="6592" class="Symbol">)))</a> <a id="6596" class="Symbol">=</a> <a id="6598" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6603" class="Symbol">(</a><a id="6604" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6609" class="Symbol">(</a><a id="6610" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="6615" href="GUI.GUIFeaturesMonadicPaper.html#6590" class="Bound">s&#39;</a><a id="6617" class="Symbol">))</a>
<a id="6620" href="GUI.GUIFeaturesMonadicPaper.html#6384" class="Function">mapS⊎[S&#39;⊎S&#39;&#39;]⊎A</a> <a id="6636" class="Symbol">(</a><a id="6637" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6642" class="Symbol">(</a><a id="6643" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="6648" class="Symbol">(</a><a id="6649" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="6654" href="GUI.GUIFeaturesMonadicPaper.html#6654" class="Bound">s&#39;&#39;</a><a id="6657" class="Symbol">)))</a> <a id="6661" class="Symbol">=</a> <a id="6663" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="6668" class="Symbol">(</a><a id="6669" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="6674" href="GUI.GUIFeaturesMonadicPaper.html#6654" class="Bound">s&#39;&#39;</a><a id="6677" class="Symbol">)</a>
<a id="6679" href="GUI.GUIFeaturesMonadicPaper.html#6384" class="Function">mapS⊎[S&#39;⊎S&#39;&#39;]⊎A</a> <a id="6695" class="Symbol">(</a><a id="6696" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="6701" href="GUI.GUIFeaturesMonadicPaper.html#6701" class="Bound">a</a><a id="6702" class="Symbol">)</a> <a id="6704" class="Symbol">=</a> <a id="6706" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="6711" href="GUI.GUIFeaturesMonadicPaper.html#6701" class="Bound">a</a>




<a id="extendSMachFixedStateMonadic"></a><a id="6717" href="GUI.GUIFeaturesMonadicPaper.html#6717" class="Function">extendSMachFixedStateMonadic</a> <a id="6746" class="Symbol">:</a> <a id="6748" class="Symbol">{</a><a id="6749" href="GUI.GUIFeaturesMonadicPaper.html#6749" class="Bound">A</a> <a id="6751" href="GUI.GUIFeaturesMonadicPaper.html#6751" class="Bound">S</a> <a id="6753" href="GUI.GUIFeaturesMonadicPaper.html#6753" class="Bound">S&#39;</a> <a id="6756" href="GUI.GUIFeaturesMonadicPaper.html#6756" class="Bound">S&#39;&#39;</a> <a id="6760" class="Symbol">:</a> <a id="6762" class="PrimitiveType">Set</a><a id="6765" class="Symbol">}</a>
                        <a id="6791" class="Symbol">(</a><a id="6792" href="GUI.GUIFeaturesMonadicPaper.html#6792" class="Bound">sm</a> <a id="6795" class="Symbol">:</a> <a id="6797" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a>  <a id="6818" href="GUI.GUIFeaturesMonadicPaper.html#6749" class="Bound">A</a> <a id="6820" class="Symbol">(</a><a id="6821" href="GUI.GUIFeaturesMonadicPaper.html#6751" class="Bound">S</a> <a id="6823" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6825" href="GUI.GUIFeaturesMonadicPaper.html#6753" class="Bound">S&#39;</a><a id="6827" class="Symbol">))</a>
                        <a id="6854" class="Symbol">(</a><a id="6855" href="GUI.GUIFeaturesMonadicPaper.html#6855" class="Bound">new</a> <a id="6859" class="Symbol">:</a> <a id="6861" class="Symbol">(</a><a id="6862" href="GUI.GUIFeaturesMonadicPaper.html#6862" class="Bound">s&#39;&#39;</a> <a id="6866" class="Symbol">:</a> <a id="6868" href="GUI.GUIFeaturesMonadicPaper.html#6756" class="Bound">S&#39;&#39;</a><a id="6871" class="Symbol">)</a>
                        <a id="6897" class="Symbol">→</a> <a id="6899" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="6912" class="Symbol">((</a><a id="6914" href="GUI.GUIFeaturesMonadicPaper.html#6751" class="Bound">S</a> <a id="6916" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6918" class="Symbol">(</a><a id="6919" href="GUI.GUIFeaturesMonadicPaper.html#6753" class="Bound">S&#39;</a> <a id="6922" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6924" href="GUI.GUIFeaturesMonadicPaper.html#6756" class="Bound">S&#39;&#39;</a><a id="6927" class="Symbol">))</a> <a id="6930" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="6932" href="GUI.GUIFeaturesMonadicPaper.html#6749" class="Bound">A</a><a id="6933" class="Symbol">)</a> <a id="6935" class="Comment">{-(inj₂ (inj₂ s&#39;&#39;))-}</a><a id="6956" class="Symbol">)</a>
                        <a id="6982" class="Symbol">→</a> <a id="6984" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="7004" href="GUI.GUIFeaturesMonadicPaper.html#6749" class="Bound">A</a> <a id="7006" class="Symbol">(</a><a id="7007" href="GUI.GUIFeaturesMonadicPaper.html#6751" class="Bound">S</a> <a id="7009" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7011" class="Symbol">(</a><a id="7012" href="GUI.GUIFeaturesMonadicPaper.html#6753" class="Bound">S&#39;</a> <a id="7015" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7017" href="GUI.GUIFeaturesMonadicPaper.html#6756" class="Bound">S&#39;&#39;</a><a id="7020" class="Symbol">))</a>
<a id="7023" href="GUI.GUIFeaturesMonadicPaper.html#6717" class="Function">extendSMachFixedStateMonadic</a> <a id="7052" class="Symbol">{</a><a id="7053" href="GUI.GUIFeaturesMonadicPaper.html#7053" class="Bound">A</a><a id="7054" class="Symbol">}</a> <a id="7056" class="Symbol">{</a><a id="7057" href="GUI.GUIFeaturesMonadicPaper.html#7057" class="Bound">S</a><a id="7058" class="Symbol">}</a> <a id="7060" class="Symbol">{</a><a id="7061" href="GUI.GUIFeaturesMonadicPaper.html#7061" class="Bound">S&#39;</a><a id="7063" class="Symbol">}</a> <a id="7065" class="Symbol">{</a><a id="7066" href="GUI.GUIFeaturesMonadicPaper.html#7066" class="Bound">S&#39;&#39;</a><a id="7069" class="Symbol">}</a> <a id="7071" href="GUI.GUIFeaturesMonadicPaper.html#7071" class="Bound">sm</a> <a id="7074" href="GUI.GUIFeaturesMonadicPaper.html#7074" class="Bound">new</a> <a id="7078" class="Symbol">=</a>
    <a id="7084" href="GUI.GUIFeaturesMonadicPaper.html#6113" class="Function">adaptStateMachineMonadic</a> <a id="7109" href="GUI.GUIFeaturesPart8Paper.html#3942" class="Function">map[S⊎S&#39;]⊎S&#39;&#39;]</a> <a id="7124" href="GUI.GUIFeaturesPart8Paper.html#3714" class="Function">mapS⊎[S&#39;⊎S&#39;&#39;]</a>
    <a id="7142" class="Symbol">(</a><a id="7143" href="GUI.GUIFeaturesMonadicPaper.html#5217" class="Function">extendStateMachineMonadic</a> <a id="7169" href="GUI.GUIFeaturesMonadicPaper.html#7071" class="Bound">sm</a>
       <a id="7179" class="Symbol">(λ</a> <a id="7182" href="GUI.GUIFeaturesMonadicPaper.html#7182" class="Bound">s&#39;&#39;</a> <a id="7186" class="Symbol">→</a> <a id="7188" href="GUI.GUIFeaturesPart8Paper.html#1929" class="Function">adaptStateSMachineState</a> <a id="7212" class="Symbol">{(</a><a id="7214" href="GUI.GUIFeaturesMonadicPaper.html#7057" class="Bound">S</a> <a id="7216" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7218" href="GUI.GUIFeaturesMonadicPaper.html#7061" class="Bound">S&#39;</a> <a id="7221" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7223" href="GUI.GUIFeaturesMonadicPaper.html#7066" class="Bound">S&#39;&#39;</a><a id="7226" class="Symbol">)</a> <a id="7228" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7230" href="GUI.GUIFeaturesMonadicPaper.html#7053" class="Bound">A</a><a id="7231" class="Symbol">}</a>
                <a id="7249" class="Symbol">{((</a><a id="7252" href="GUI.GUIFeaturesMonadicPaper.html#7057" class="Bound">S</a> <a id="7254" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7256" href="GUI.GUIFeaturesMonadicPaper.html#7061" class="Bound">S&#39;</a><a id="7258" class="Symbol">)</a> <a id="7260" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7262" href="GUI.GUIFeaturesMonadicPaper.html#7066" class="Bound">S&#39;&#39;</a><a id="7265" class="Symbol">)</a> <a id="7267" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7269" href="GUI.GUIFeaturesMonadicPaper.html#7053" class="Bound">A</a><a id="7270" class="Symbol">}</a> <a id="7272" href="GUI.GUIFeaturesMonadicPaper.html#6384" class="Function">mapS⊎[S&#39;⊎S&#39;&#39;]⊎A</a>
                <a id="7304" class="Comment">{-(inj₂ (inj₂ s&#39;&#39;))-}</a> <a id="7326" class="Comment">{-(inj₂ s&#39;&#39;)-}</a> <a id="7341" class="Symbol">((</a><a id="7343" href="GUI.GUIFeaturesMonadicPaper.html#7074" class="Bound">new</a> <a id="7347" href="GUI.GUIFeaturesMonadicPaper.html#7182" class="Bound">s&#39;&#39;</a><a id="7350" class="Symbol">))))</a>


<a id="extendFMachFixedStateMonadic"></a><a id="7357" href="GUI.GUIFeaturesMonadicPaper.html#7357" class="Function">extendFMachFixedStateMonadic</a> <a id="7386" class="Symbol">:</a> <a id="7388" class="Symbol">{</a><a id="7389" href="GUI.GUIFeaturesMonadicPaper.html#7389" class="Bound">A</a> <a id="7391" class="Symbol">:</a> <a id="7393" class="PrimitiveType">Set</a><a id="7396" class="Symbol">}{</a><a id="7398" href="GUI.GUIFeaturesMonadicPaper.html#7398" class="Bound">F</a> <a id="7400" class="Symbol">:</a> <a id="7402" class="PrimitiveType">Set</a><a id="7405" class="Symbol">}</a> <a id="7407" class="Symbol">{</a><a id="7408" href="GUI.GUIFeaturesMonadicPaper.html#7408" class="Bound">S</a> <a id="7410" href="GUI.GUIFeaturesMonadicPaper.html#7410" class="Bound">S&#39;</a> <a id="7413" href="GUI.GUIFeaturesMonadicPaper.html#7413" class="Bound">S&#39;&#39;</a> <a id="7417" class="Symbol">:</a> <a id="7419" class="PrimitiveType">Set</a><a id="7422" class="Symbol">}</a>
                           <a id="7451" class="Symbol">(</a><a id="7452" href="GUI.GUIFeaturesMonadicPaper.html#7452" class="Bound">fm</a> <a id="7455" class="Symbol">:</a> <a id="7457" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="7479" href="GUI.GUIFeaturesMonadicPaper.html#7389" class="Bound">A</a> <a id="7481" href="GUI.GUIFeaturesMonadicPaper.html#7398" class="Bound">F</a> <a id="7483" class="Symbol">(</a><a id="7484" href="GUI.GUIFeaturesMonadicPaper.html#7408" class="Bound">S</a> <a id="7486" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7488" href="GUI.GUIFeaturesMonadicPaper.html#7410" class="Bound">S&#39;</a><a id="7490" class="Symbol">))</a>
                          <a id="7519" class="Symbol">(</a><a id="7520" href="GUI.GUIFeaturesMonadicPaper.html#7520" class="Bound">new</a> <a id="7524" class="Symbol">:</a> <a id="7526" class="Symbol">(</a><a id="7527" href="GUI.GUIFeaturesMonadicPaper.html#7527" class="Bound">f</a> <a id="7529" class="Symbol">:</a> <a id="7531" href="GUI.GUIFeaturesMonadicPaper.html#7398" class="Bound">F</a><a id="7532" class="Symbol">)(</a><a id="7534" href="GUI.GUIFeaturesMonadicPaper.html#7534" class="Bound">s&#39;&#39;</a> <a id="7538" class="Symbol">:</a> <a id="7540" href="GUI.GUIFeaturesMonadicPaper.html#7413" class="Bound">S&#39;&#39;</a><a id="7543" class="Symbol">)</a>
                           <a id="7572" class="Symbol">→</a> <a id="7574" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="7587" class="Symbol">((</a><a id="7589" href="GUI.GUIFeaturesMonadicPaper.html#7408" class="Bound">S</a> <a id="7591" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7593" class="Symbol">(</a><a id="7594" href="GUI.GUIFeaturesMonadicPaper.html#7410" class="Bound">S&#39;</a> <a id="7597" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7599" href="GUI.GUIFeaturesMonadicPaper.html#7413" class="Bound">S&#39;&#39;</a><a id="7602" class="Symbol">))</a> <a id="7605" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7607" href="GUI.GUIFeaturesMonadicPaper.html#7389" class="Bound">A</a><a id="7608" class="Symbol">)</a> <a id="7610" class="Comment">{-(inj₂ (inj₂ s&#39;&#39;))-}</a><a id="7631" class="Symbol">)</a>
                          <a id="7659" class="Symbol">→</a> <a id="7661" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="7683" href="GUI.GUIFeaturesMonadicPaper.html#7389" class="Bound">A</a> <a id="7685" href="GUI.GUIFeaturesMonadicPaper.html#7398" class="Bound">F</a> <a id="7687" class="Symbol">(</a><a id="7688" href="GUI.GUIFeaturesMonadicPaper.html#7408" class="Bound">S</a> <a id="7690" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7692" class="Symbol">(</a><a id="7693" href="GUI.GUIFeaturesMonadicPaper.html#7410" class="Bound">S&#39;</a> <a id="7696" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7698" href="GUI.GUIFeaturesMonadicPaper.html#7413" class="Bound">S&#39;&#39;</a><a id="7701" class="Symbol">))</a>
<a id="7704" href="GUI.GUIFeaturesMonadicPaper.html#7357" class="Function">extendFMachFixedStateMonadic</a> <a id="7733" href="GUI.GUIFeaturesMonadicPaper.html#7733" class="Bound">fm</a> <a id="7736" href="GUI.GUIFeaturesMonadicPaper.html#7736" class="Bound">new</a> <a id="7740" href="GUI.GUIFeaturesMonadicPaper.html#7740" class="Bound">f</a> <a id="7742" class="Symbol">=</a> <a id="7744" href="GUI.GUIFeaturesMonadicPaper.html#6717" class="Function">extendSMachFixedStateMonadic</a> <a id="7773" class="Symbol">(</a><a id="7774" href="GUI.GUIFeaturesMonadicPaper.html#7733" class="Bound">fm</a> <a id="7777" href="GUI.GUIFeaturesMonadicPaper.html#7740" class="Bound">f</a><a id="7778" class="Symbol">)</a> <a id="7780" class="Symbol">(</a><a id="7781" href="GUI.GUIFeaturesMonadicPaper.html#7736" class="Bound">new</a> <a id="7785" href="GUI.GUIFeaturesMonadicPaper.html#7740" class="Bound">f</a><a id="7786" class="Symbol">)</a>

<a id="extendFMachFixedState1Monadic"></a><a id="7789" href="GUI.GUIFeaturesMonadicPaper.html#7789" class="Function">extendFMachFixedState1Monadic</a> <a id="7819" class="Symbol">:</a> <a id="7821" class="Symbol">{</a><a id="7822" href="GUI.GUIFeaturesMonadicPaper.html#7822" class="Bound">A</a> <a id="7824" class="Symbol">:</a> <a id="7826" class="PrimitiveType">Set</a><a id="7829" class="Symbol">}</a> <a id="7831" class="Symbol">{</a><a id="7832" href="GUI.GUIFeaturesMonadicPaper.html#7832" class="Bound">F</a> <a id="7834" class="Symbol">:</a> <a id="7836" class="PrimitiveType">Set</a><a id="7839" class="Symbol">}</a> <a id="7841" class="Symbol">{</a><a id="7842" href="GUI.GUIFeaturesMonadicPaper.html#7842" class="Bound">S</a> <a id="7844" href="GUI.GUIFeaturesMonadicPaper.html#7844" class="Bound">S&#39;</a> <a id="7847" class="Symbol">:</a> <a id="7849" class="PrimitiveType">Set</a><a id="7852" class="Symbol">}</a>
                         <a id="7879" class="Symbol">(</a><a id="7880" href="GUI.GUIFeaturesMonadicPaper.html#7880" class="Bound">fm</a> <a id="7883" class="Symbol">:</a> <a id="7885" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="7907" href="GUI.GUIFeaturesMonadicPaper.html#7822" class="Bound">A</a> <a id="7909" href="GUI.GUIFeaturesMonadicPaper.html#7832" class="Bound">F</a> <a id="7911" class="Symbol">(</a><a id="7912" href="GUI.GUIFeaturesMonadicPaper.html#7842" class="Bound">S</a> <a id="7914" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7916" href="GUI.GUIFeaturesMonadicPaper.html#7844" class="Bound">S&#39;</a><a id="7918" class="Symbol">))</a>
                         <a id="7946" class="Symbol">(</a><a id="7947" href="GUI.GUIFeaturesMonadicPaper.html#7947" class="Bound">new</a> <a id="7951" class="Symbol">:</a> <a id="7953" href="GUI.GUIFeaturesPart2Paper.html#812" class="Record">MachineState</a> <a id="7966" class="Symbol">((</a><a id="7968" href="GUI.GUIFeaturesMonadicPaper.html#7842" class="Bound">S</a> <a id="7970" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7972" class="Symbol">(</a><a id="7973" href="GUI.GUIFeaturesMonadicPaper.html#7844" class="Bound">S&#39;</a> <a id="7976" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7978" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="7979" class="Symbol">))</a> <a id="7982" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="7984" href="GUI.GUIFeaturesMonadicPaper.html#7822" class="Bound">A</a><a id="7985" class="Symbol">)</a> <a id="7987" class="Comment">{-(inj₂ (inj₂ _))-}</a><a id="8006" class="Symbol">)</a>
                          <a id="8034" class="Symbol">→</a> <a id="8036" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="8058" href="GUI.GUIFeaturesMonadicPaper.html#7822" class="Bound">A</a> <a id="8060" href="GUI.GUIFeaturesMonadicPaper.html#7832" class="Bound">F</a> <a id="8062" class="Symbol">(</a><a id="8063" href="GUI.GUIFeaturesMonadicPaper.html#7842" class="Bound">S</a> <a id="8065" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="8067" class="Symbol">(</a><a id="8068" href="GUI.GUIFeaturesMonadicPaper.html#7844" class="Bound">S&#39;</a> <a id="8071" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="8073" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="8074" class="Symbol">))</a>
<a id="8077" href="GUI.GUIFeaturesMonadicPaper.html#7789" class="Function">extendFMachFixedState1Monadic</a> <a id="8107" href="GUI.GUIFeaturesMonadicPaper.html#8107" class="Bound">fm</a> <a id="8110" href="GUI.GUIFeaturesMonadicPaper.html#8110" class="Bound">new</a> <a id="8114" href="GUI.GUIFeaturesMonadicPaper.html#8114" class="Bound">f</a> <a id="8116" class="Symbol">=</a> <a id="8118" href="GUI.GUIFeaturesMonadicPaper.html#6717" class="Function">extendSMachFixedStateMonadic</a> <a id="8147" class="Symbol">(</a><a id="8148" href="GUI.GUIFeaturesMonadicPaper.html#8107" class="Bound">fm</a> <a id="8151" href="GUI.GUIFeaturesMonadicPaper.html#8114" class="Bound">f</a><a id="8152" class="Symbol">)</a> <a id="8154" class="Symbol">(λ</a> <a id="8157" href="GUI.GUIFeaturesMonadicPaper.html#8157" class="Bound">_</a> <a id="8159" class="Symbol">→</a>  <a id="8162" href="GUI.GUIFeaturesMonadicPaper.html#8110" class="Bound">new</a> <a id="8166" class="Symbol">)</a>

<a id="adaptFeatureFMachMonadic"></a><a id="8169" href="GUI.GUIFeaturesMonadicPaper.html#8169" class="Function">adaptFeatureFMachMonadic</a> <a id="8194" class="Symbol">:</a> <a id="8196" class="Symbol">{</a><a id="8197" href="GUI.GUIFeaturesMonadicPaper.html#8197" class="Bound">A</a> <a id="8199" href="GUI.GUIFeaturesMonadicPaper.html#8199" class="Bound">F</a> <a id="8201" href="GUI.GUIFeaturesMonadicPaper.html#8201" class="Bound">F&#39;</a> <a id="8204" class="Symbol">:</a> <a id="8206" class="PrimitiveType">Set</a><a id="8209" class="Symbol">}(</a><a id="8211" href="GUI.GUIFeaturesMonadicPaper.html#8211" class="Bound">f&#39;f</a> <a id="8215" class="Symbol">:</a> <a id="8217" href="GUI.GUIFeaturesMonadicPaper.html#8201" class="Bound">F&#39;</a> <a id="8220" class="Symbol">→</a>  <a id="8223" href="GUI.GUIFeaturesMonadicPaper.html#8199" class="Bound">F</a><a id="8224" class="Symbol">)</a>
                     <a id="8247" class="Symbol">{</a><a id="8248" href="GUI.GUIFeaturesMonadicPaper.html#8248" class="Bound">S</a> <a id="8250" class="Symbol">:</a> <a id="8252" class="PrimitiveType">Set</a><a id="8255" class="Symbol">}</a>
                     <a id="8278" class="Symbol">(</a><a id="8279" href="GUI.GUIFeaturesMonadicPaper.html#8279" class="Bound">fm</a> <a id="8282" class="Symbol">:</a> <a id="8284" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="8306" href="GUI.GUIFeaturesMonadicPaper.html#8197" class="Bound">A</a> <a id="8308" href="GUI.GUIFeaturesMonadicPaper.html#8199" class="Bound">F</a> <a id="8310" href="GUI.GUIFeaturesMonadicPaper.html#8248" class="Bound">S</a><a id="8311" class="Symbol">)</a>
                     <a id="8334" class="Symbol">→</a> <a id="8336" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="8358" href="GUI.GUIFeaturesMonadicPaper.html#8197" class="Bound">A</a> <a id="8360" href="GUI.GUIFeaturesMonadicPaper.html#8201" class="Bound">F&#39;</a> <a id="8363" href="GUI.GUIFeaturesMonadicPaper.html#8248" class="Bound">S</a>
<a id="8365" href="GUI.GUIFeaturesMonadicPaper.html#8169" class="Function">adaptFeatureFMachMonadic</a> <a id="8390" href="GUI.GUIFeaturesMonadicPaper.html#8390" class="Bound">f&#39;f</a> <a id="8394" href="GUI.GUIFeaturesMonadicPaper.html#8394" class="Bound">fm</a> <a id="8397" href="GUI.GUIFeaturesMonadicPaper.html#8397" class="Bound">f&#39;</a> <a id="8400" class="Symbol">=</a> <a id="8402" href="GUI.GUIFeaturesMonadicPaper.html#8394" class="Bound">fm</a> <a id="8405" class="Symbol">(</a><a id="8406" href="GUI.GUIFeaturesMonadicPaper.html#8390" class="Bound">f&#39;f</a> <a id="8410" href="GUI.GUIFeaturesMonadicPaper.html#8397" class="Bound">f&#39;</a><a id="8412" class="Symbol">)</a>


<a id="extendFeatureFMachMonadic"></a><a id="8416" href="GUI.GUIFeaturesMonadicPaper.html#8416" class="Function">extendFeatureFMachMonadic</a> <a id="8442" class="Symbol">:</a> <a id="8444" class="Symbol">{</a><a id="8445" href="GUI.GUIFeaturesMonadicPaper.html#8445" class="Bound">A</a> <a id="8447" href="GUI.GUIFeaturesMonadicPaper.html#8447" class="Bound">F</a> <a id="8449" href="GUI.GUIFeaturesMonadicPaper.html#8449" class="Bound">F&#39;</a> <a id="8452" class="Symbol">:</a> <a id="8454" class="PrimitiveType">Set</a><a id="8457" class="Symbol">}</a>
                  <a id="8477" class="Symbol">{</a><a id="8478" href="GUI.GUIFeaturesMonadicPaper.html#8478" class="Bound">S</a> <a id="8480" class="Symbol">:</a> <a id="8482" class="PrimitiveType">Set</a><a id="8485" class="Symbol">}</a>
                  <a id="8505" class="Symbol">(</a><a id="8506" href="GUI.GUIFeaturesMonadicPaper.html#8506" class="Bound">fm</a> <a id="8509" class="Symbol">:</a> <a id="8511" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="8533" href="GUI.GUIFeaturesMonadicPaper.html#8445" class="Bound">A</a> <a id="8535" href="GUI.GUIFeaturesMonadicPaper.html#8447" class="Bound">F</a> <a id="8537" href="GUI.GUIFeaturesMonadicPaper.html#8478" class="Bound">S</a><a id="8538" class="Symbol">)</a>
                  <a id="8558" class="Symbol">→</a> <a id="8560" href="GUI.GUIFeaturesMonadicPaper.html#1214" class="Function">FeatureMachineMonadic</a> <a id="8582" href="GUI.GUIFeaturesMonadicPaper.html#8445" class="Bound">A</a> <a id="8584" class="Symbol">(</a><a id="8585" href="GUI.GUIFeaturesMonadicPaper.html#8447" class="Bound">F</a> <a id="8587" href="Data.Product.html#1329" class="Function Operator">×</a> <a id="8589" href="GUI.GUIFeaturesMonadicPaper.html#8449" class="Bound">F&#39;</a><a id="8591" class="Symbol">)</a> <a id="8593" href="GUI.GUIFeaturesMonadicPaper.html#8478" class="Bound">S</a>
<a id="8595" href="GUI.GUIFeaturesMonadicPaper.html#8416" class="Function">extendFeatureFMachMonadic</a> <a id="8621" href="GUI.GUIFeaturesMonadicPaper.html#8621" class="Bound">fm</a> <a id="8624" class="Symbol">=</a> <a id="8626" href="GUI.GUIFeaturesMonadicPaper.html#8169" class="Function">adaptFeatureFMachMonadic</a> <a id="8651" href="Data.Product.html#559" class="Field">proj₁</a> <a id="8657" href="GUI.GUIFeaturesMonadicPaper.html#8621" class="Bound">fm</a>

<a id="8661" class="Comment">-- Now as before but the states depend on the feature</a>

<a id="8716" class="Comment">-- FMachine where the states depend on the feature</a>
<a id="FeatureMachineMonadicΣ"></a><a id="8767" href="GUI.GUIFeaturesMonadicPaper.html#8767" class="Function">FeatureMachineMonadicΣ</a>  <a id="8791" class="Symbol">:</a> <a id="8793" class="Symbol">(</a><a id="8794" href="GUI.GUIFeaturesMonadicPaper.html#8794" class="Bound">A</a> <a id="8796" class="Symbol">:</a> <a id="8798" class="PrimitiveType">Set</a><a id="8801" class="Symbol">)(</a><a id="8803" href="GUI.GUIFeaturesMonadicPaper.html#8803" class="Bound">F</a> <a id="8805" class="Symbol">:</a> <a id="8807" class="PrimitiveType">Set</a><a id="8810" class="Symbol">)(</a><a id="8812" href="GUI.GUIFeaturesMonadicPaper.html#8812" class="Bound">S</a> <a id="8814" class="Symbol">:</a> <a id="8816" href="GUI.GUIFeaturesMonadicPaper.html#8803" class="Bound">F</a> <a id="8818" class="Symbol">→</a> <a id="8820" class="PrimitiveType">Set</a><a id="8823" class="Symbol">)</a> <a id="8825" class="Symbol">→</a> <a id="8827" class="PrimitiveType">Set</a>
<a id="8831" href="GUI.GUIFeaturesMonadicPaper.html#8767" class="Function">FeatureMachineMonadicΣ</a> <a id="8854" href="GUI.GUIFeaturesMonadicPaper.html#8854" class="Bound">A</a> <a id="8856" href="GUI.GUIFeaturesMonadicPaper.html#8856" class="Bound">F</a> <a id="8858" href="GUI.GUIFeaturesMonadicPaper.html#8858" class="Bound">S</a> <a id="8860" class="Symbol">=</a> <a id="8862" class="Symbol">(</a><a id="8863" href="GUI.GUIFeaturesMonadicPaper.html#8863" class="Bound">f</a> <a id="8865" class="Symbol">:</a> <a id="8867" href="GUI.GUIFeaturesMonadicPaper.html#8856" class="Bound">F</a><a id="8868" class="Symbol">)</a> <a id="8870" class="Symbol">→</a> <a id="8872" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="8892" href="GUI.GUIFeaturesMonadicPaper.html#8854" class="Bound">A</a> <a id="8894" class="Symbol">(</a><a id="8895" href="GUI.GUIFeaturesMonadicPaper.html#8858" class="Bound">S</a> <a id="8897" href="GUI.GUIFeaturesMonadicPaper.html#8863" class="Bound">f</a><a id="8898" class="Symbol">)</a>

<a id="8901" class="Comment">-- auxiliary functions  used in the map in the next operation</a>
<a id="featureMachineMonadic2StateMachineMonadicauxΣ"></a><a id="8963" href="GUI.GUIFeaturesMonadicPaper.html#8963" class="Function">featureMachineMonadic2StateMachineMonadicauxΣ</a>   <a id="9011" class="Symbol">:</a> <a id="9013" class="Symbol">{</a><a id="9014" href="GUI.GUIFeaturesMonadicPaper.html#9014" class="Bound">F</a> <a id="9016" class="Symbol">:</a> <a id="9018" class="PrimitiveType">Set</a><a id="9021" class="Symbol">}{</a><a id="9023" href="GUI.GUIFeaturesMonadicPaper.html#9023" class="Bound">S</a> <a id="9025" class="Symbol">:</a> <a id="9027" href="GUI.GUIFeaturesMonadicPaper.html#9014" class="Bound">F</a> <a id="9029" class="Symbol">→</a> <a id="9031" class="PrimitiveType">Set</a><a id="9034" class="Symbol">}{</a><a id="9036" href="GUI.GUIFeaturesMonadicPaper.html#9036" class="Bound">S&#39;</a> <a id="9039" class="Symbol">:</a> <a id="9041" class="PrimitiveType">Set</a><a id="9044" class="Symbol">}</a>
       <a id="9053" class="Symbol">(</a><a id="9054" href="GUI.GUIFeaturesMonadicPaper.html#9054" class="Bound">f</a> <a id="9056" class="Symbol">:</a> <a id="9058" href="GUI.GUIFeaturesMonadicPaper.html#9014" class="Bound">F</a><a id="9059" class="Symbol">)</a>
       <a id="9068" class="Symbol">(</a><a id="9069" href="GUI.GUIFeaturesMonadicPaper.html#9069" class="Bound">ss&#39;</a> <a id="9073" class="Symbol">:</a> <a id="9075" href="GUI.GUIFeaturesMonadicPaper.html#9023" class="Bound">S</a> <a id="9077" href="GUI.GUIFeaturesMonadicPaper.html#9054" class="Bound">f</a> <a id="9079" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="9081" href="GUI.GUIFeaturesMonadicPaper.html#9036" class="Bound">S&#39;</a><a id="9083" class="Symbol">)</a>
       <a id="9092" class="Symbol">→</a> <a id="9094" href="Data.Product.html#473" class="Record">Σ</a> <a id="9096" href="GUI.GUIFeaturesMonadicPaper.html#9014" class="Bound">F</a> <a id="9098" href="GUI.GUIFeaturesMonadicPaper.html#9023" class="Bound">S</a> <a id="9100" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="9102" href="GUI.GUIFeaturesMonadicPaper.html#9036" class="Bound">S&#39;</a>  <a id="9106" class="Comment">-- Σ[ f ∈ F ](S f) ⊎ S&#39;</a>
<a id="9130" href="GUI.GUIFeaturesMonadicPaper.html#8963" class="Function">featureMachineMonadic2StateMachineMonadicauxΣ</a> <a id="9176" class="Symbol">{</a><a id="9177" href="GUI.GUIFeaturesMonadicPaper.html#9177" class="Bound">F</a><a id="9178" class="Symbol">}</a> <a id="9180" class="Symbol">{</a><a id="9181" href="GUI.GUIFeaturesMonadicPaper.html#9181" class="Bound">S</a><a id="9182" class="Symbol">}</a> <a id="9184" class="Symbol">{</a><a id="9185" href="GUI.GUIFeaturesMonadicPaper.html#9185" class="Bound">S&#39;</a><a id="9187" class="Symbol">}</a> <a id="9189" href="GUI.GUIFeaturesMonadicPaper.html#9189" class="Bound">f</a> <a id="9191" class="Symbol">(</a><a id="9192" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="9197" href="GUI.GUIFeaturesMonadicPaper.html#9197" class="Bound">s</a><a id="9198" class="Symbol">)</a>
   <a id="9203" class="Symbol">=</a> <a id="9205" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="9210" class="Symbol">(</a><a id="9211" href="GUI.GUIFeaturesMonadicPaper.html#9189" class="Bound">f</a> <a id="9213" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="9215" href="GUI.GUIFeaturesMonadicPaper.html#9197" class="Bound">s</a><a id="9216" class="Symbol">)</a>
<a id="9218" href="GUI.GUIFeaturesMonadicPaper.html#8963" class="Function">featureMachineMonadic2StateMachineMonadicauxΣ</a> <a id="9264" class="Symbol">{</a><a id="9265" href="GUI.GUIFeaturesMonadicPaper.html#9265" class="Bound">F</a><a id="9266" class="Symbol">}</a> <a id="9268" class="Symbol">{</a><a id="9269" href="GUI.GUIFeaturesMonadicPaper.html#9269" class="Bound">S</a><a id="9270" class="Symbol">}</a> <a id="9272" class="Symbol">{</a><a id="9273" href="GUI.GUIFeaturesMonadicPaper.html#9273" class="Bound">S&#39;</a><a id="9275" class="Symbol">}</a> <a id="9277" href="GUI.GUIFeaturesMonadicPaper.html#9277" class="Bound">f</a> <a id="9279" class="Symbol">(</a><a id="9280" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="9285" href="GUI.GUIFeaturesMonadicPaper.html#9285" class="Bound">s&#39;</a><a id="9287" class="Symbol">)</a>
  <a id="9291" class="Symbol">=</a> <a id="9293" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="9298" href="GUI.GUIFeaturesMonadicPaper.html#9285" class="Bound">s&#39;</a>

<a id="9302" class="Comment">-- take a monadic F machine with rerturn values in S&#39;</a>
<a id="9356" class="Comment">-- into a monadic S machine with rerturn values in S&#39;</a>
<a id="featureMachineMonadic2StateMachineMonadicΣ"></a><a id="9410" href="GUI.GUIFeaturesMonadicPaper.html#9410" class="Function">featureMachineMonadic2StateMachineMonadicΣ</a> <a id="9453" class="Symbol">:</a> <a id="9455" class="Symbol">{</a><a id="9456" href="GUI.GUIFeaturesMonadicPaper.html#9456" class="Bound">F</a> <a id="9458" class="Symbol">:</a> <a id="9460" class="PrimitiveType">Set</a><a id="9463" class="Symbol">}{</a><a id="9465" href="GUI.GUIFeaturesMonadicPaper.html#9465" class="Bound">S</a> <a id="9467" class="Symbol">:</a> <a id="9469" href="GUI.GUIFeaturesMonadicPaper.html#9456" class="Bound">F</a> <a id="9471" class="Symbol">→</a> <a id="9473" class="PrimitiveType">Set</a><a id="9476" class="Symbol">}{</a><a id="9478" href="GUI.GUIFeaturesMonadicPaper.html#9478" class="Bound">S&#39;</a> <a id="9481" class="Symbol">:</a> <a id="9483" class="PrimitiveType">Set</a><a id="9486" class="Symbol">}</a>
                          <a id="9514" class="Symbol">(</a><a id="9515" href="GUI.GUIFeaturesMonadicPaper.html#9515" class="Bound">fmachine</a> <a id="9524" class="Symbol">:</a> <a id="9526" href="GUI.GUIFeaturesMonadicPaper.html#8767" class="Function">FeatureMachineMonadicΣ</a> <a id="9549" href="GUI.GUIFeaturesMonadicPaper.html#9478" class="Bound">S&#39;</a> <a id="9552" href="GUI.GUIFeaturesMonadicPaper.html#9456" class="Bound">F</a> <a id="9554" href="GUI.GUIFeaturesMonadicPaper.html#9465" class="Bound">S</a><a id="9555" class="Symbol">)</a>
                          <a id="9583" class="Symbol">→</a> <a id="9585" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="9605" href="GUI.GUIFeaturesMonadicPaper.html#9478" class="Bound">S&#39;</a> <a id="9608" class="Symbol">(</a><a id="9609" href="Data.Product.html#473" class="Record">Σ</a> <a id="9611" href="GUI.GUIFeaturesMonadicPaper.html#9456" class="Bound">F</a> <a id="9613" href="GUI.GUIFeaturesMonadicPaper.html#9465" class="Bound">S</a><a id="9614" class="Symbol">)</a>
<a id="9616" href="GUI.GUIFeaturesMonadicPaper.html#9410" class="Function">featureMachineMonadic2StateMachineMonadicΣ</a> <a id="9659" class="Symbol">{</a><a id="9660" href="GUI.GUIFeaturesMonadicPaper.html#9660" class="Bound">F</a><a id="9661" class="Symbol">}</a> <a id="9663" class="Symbol">{</a><a id="9664" href="GUI.GUIFeaturesMonadicPaper.html#9664" class="Bound">S</a><a id="9665" class="Symbol">}</a> <a id="9667" class="Symbol">{</a><a id="9668" href="GUI.GUIFeaturesMonadicPaper.html#9668" class="Bound">S&#39;</a><a id="9670" class="Symbol">}</a> <a id="9672" href="GUI.GUIFeaturesMonadicPaper.html#9672" class="Bound">fmachine</a> <a id="9681" class="Symbol">(</a><a id="9682" href="GUI.GUIFeaturesMonadicPaper.html#9682" class="Bound">f</a> <a id="9684" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="9686" href="GUI.GUIFeaturesMonadicPaper.html#9686" class="Bound">s</a><a id="9687" class="Symbol">)</a>
     <a id="9694" class="Symbol">=</a> <a id="9696" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a> <a id="9712" class="Symbol">(</a><a id="9713" href="GUI.GUIFeaturesMonadicPaper.html#8963" class="Function">featureMachineMonadic2StateMachineMonadicauxΣ</a> <a id="9759" href="GUI.GUIFeaturesMonadicPaper.html#9682" class="Bound">f</a><a id="9760" class="Symbol">)</a> <a id="9762" class="Symbol">(</a><a id="9763" href="GUI.GUIFeaturesMonadicPaper.html#9672" class="Bound">fmachine</a> <a id="9772" href="GUI.GUIFeaturesMonadicPaper.html#9682" class="Bound">f</a> <a id="9774" href="GUI.GUIFeaturesMonadicPaper.html#9686" class="Bound">s</a><a id="9775" class="Symbol">)</a>

<a id="combineStateFeatureMachineauxΣ"></a><a id="9778" href="GUI.GUIFeaturesMonadicPaper.html#9778" class="Function">combineStateFeatureMachineauxΣ</a> <a id="9809" class="Symbol">:</a> <a id="9811" class="Symbol">{</a><a id="9812" href="GUI.GUIFeaturesMonadicPaper.html#9812" class="Bound">F</a> <a id="9814" href="GUI.GUIFeaturesMonadicPaper.html#9814" class="Bound">S</a> <a id="9816" class="Symbol">:</a> <a id="9818" class="PrimitiveType">Set</a><a id="9821" class="Symbol">}{</a><a id="9823" href="GUI.GUIFeaturesMonadicPaper.html#9823" class="Bound">S&#39;</a> <a id="9826" class="Symbol">:</a> <a id="9828" href="GUI.GUIFeaturesMonadicPaper.html#9812" class="Bound">F</a> <a id="9830" class="Symbol">→</a> <a id="9832" class="PrimitiveType">Set</a><a id="9835" class="Symbol">}</a>
                                    <a id="9873" class="Symbol">(</a><a id="9874" href="GUI.GUIFeaturesMonadicPaper.html#9874" class="Bound">f</a> <a id="9876" class="Symbol">:</a> <a id="9878" href="GUI.GUIFeaturesMonadicPaper.html#9812" class="Bound">F</a><a id="9879" class="Symbol">)</a>
                                    <a id="9917" class="Symbol">(</a><a id="9918" href="GUI.GUIFeaturesMonadicPaper.html#9918" class="Bound">s&#39;s</a> <a id="9922" class="Symbol">:</a> <a id="9924" href="GUI.GUIFeaturesMonadicPaper.html#9823" class="Bound">S&#39;</a> <a id="9927" href="GUI.GUIFeaturesMonadicPaper.html#9874" class="Bound">f</a> <a id="9929" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="9931" href="GUI.GUIFeaturesMonadicPaper.html#9814" class="Bound">S</a><a id="9932" class="Symbol">)</a>
                                    <a id="9970" class="Symbol">→</a> <a id="9972" href="GUI.GUIFeaturesMonadicPaper.html#9814" class="Bound">S</a> <a id="9974" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="9976" class="Symbol">(</a><a id="9977" href="Data.Product.html#473" class="Record">Σ</a> <a id="9979" href="GUI.GUIFeaturesMonadicPaper.html#9812" class="Bound">F</a> <a id="9981" href="GUI.GUIFeaturesMonadicPaper.html#9823" class="Bound">S&#39;</a><a id="9983" class="Symbol">)</a>
<a id="9985" href="GUI.GUIFeaturesMonadicPaper.html#9778" class="Function">combineStateFeatureMachineauxΣ</a> <a id="10016" class="Symbol">{</a><a id="10017" href="GUI.GUIFeaturesMonadicPaper.html#10017" class="Bound">F</a><a id="10018" class="Symbol">}</a> <a id="10020" class="Symbol">{</a><a id="10021" href="GUI.GUIFeaturesMonadicPaper.html#10021" class="Bound">S</a><a id="10022" class="Symbol">}</a> <a id="10024" class="Symbol">{</a><a id="10025" href="GUI.GUIFeaturesMonadicPaper.html#10025" class="Bound">S&#39;</a><a id="10027" class="Symbol">}</a> <a id="10029" href="GUI.GUIFeaturesMonadicPaper.html#10029" class="Bound">f</a> <a id="10031" class="Symbol">(</a><a id="10032" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="10037" href="GUI.GUIFeaturesMonadicPaper.html#10037" class="Bound">s&#39;</a><a id="10039" class="Symbol">)</a> <a id="10041" class="Symbol">=</a> <a id="10043" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="10048" class="Symbol">(</a><a id="10049" href="GUI.GUIFeaturesMonadicPaper.html#10029" class="Bound">f</a> <a id="10051" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="10053" href="GUI.GUIFeaturesMonadicPaper.html#10037" class="Bound">s&#39;</a><a id="10055" class="Symbol">)</a>
<a id="10057" href="GUI.GUIFeaturesMonadicPaper.html#9778" class="Function">combineStateFeatureMachineauxΣ</a> <a id="10088" class="Symbol">{</a><a id="10089" href="GUI.GUIFeaturesMonadicPaper.html#10089" class="Bound">F</a><a id="10090" class="Symbol">}</a> <a id="10092" class="Symbol">{</a><a id="10093" href="GUI.GUIFeaturesMonadicPaper.html#10093" class="Bound">S</a><a id="10094" class="Symbol">}</a> <a id="10096" class="Symbol">{</a><a id="10097" href="GUI.GUIFeaturesMonadicPaper.html#10097" class="Bound">S&#39;</a><a id="10099" class="Symbol">}</a> <a id="10101" href="GUI.GUIFeaturesMonadicPaper.html#10101" class="Bound">f</a> <a id="10103" class="Symbol">(</a><a id="10104" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="10109" href="GUI.GUIFeaturesMonadicPaper.html#10109" class="Bound">s</a><a id="10110" class="Symbol">)</a> <a id="10112" class="Symbol">=</a> <a id="10114" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="10119" href="GUI.GUIFeaturesMonadicPaper.html#10109" class="Bound">s</a>

<a id="10122" class="Comment">-- we combine one monadic S machine with return values in</a>
<a id="10180" class="Comment">--  a feature and state of a second machine</a>
<a id="10224" class="Comment">-- with a monadic feature machine  with return values</a>
<a id="10278" class="Comment">-- into the states of the first machine</a>

<a id="combineStateFeatureMachineΣ"></a><a id="10319" href="GUI.GUIFeaturesMonadicPaper.html#10319" class="Function">combineStateFeatureMachineΣ</a> <a id="10347" class="Symbol">:</a> <a id="10349" class="Symbol">{</a><a id="10350" href="GUI.GUIFeaturesMonadicPaper.html#10350" class="Bound">F</a> <a id="10352" href="GUI.GUIFeaturesMonadicPaper.html#10352" class="Bound">S</a> <a id="10354" class="Symbol">:</a> <a id="10356" class="PrimitiveType">Set</a><a id="10359" class="Symbol">}{</a><a id="10361" href="GUI.GUIFeaturesMonadicPaper.html#10361" class="Bound">S&#39;</a> <a id="10364" class="Symbol">:</a> <a id="10366" href="GUI.GUIFeaturesMonadicPaper.html#10350" class="Bound">F</a> <a id="10368" class="Symbol">→</a>  <a id="10371" class="PrimitiveType">Set</a><a id="10374" class="Symbol">}</a>
                         <a id="10401" class="Symbol">(</a><a id="10402" href="GUI.GUIFeaturesMonadicPaper.html#10402" class="Bound">machine1</a> <a id="10411" class="Symbol">:</a> <a id="10413" href="GUI.GUIFeaturesMonadicPaper.html#1120" class="Function">StateMachineMonadic</a> <a id="10433" class="Symbol">(</a><a id="10434" href="Data.Product.html#473" class="Record">Σ</a> <a id="10436" href="GUI.GUIFeaturesMonadicPaper.html#10350" class="Bound">F</a> <a id="10438" href="GUI.GUIFeaturesMonadicPaper.html#10361" class="Bound">S&#39;</a><a id="10440" class="Symbol">)</a> <a id="10442" href="GUI.GUIFeaturesMonadicPaper.html#10352" class="Bound">S</a><a id="10443" class="Symbol">)</a>
                         <a id="10470" class="Symbol">(</a><a id="10471" href="GUI.GUIFeaturesMonadicPaper.html#10471" class="Bound">machine2</a> <a id="10480" class="Symbol">:</a> <a id="10482" href="GUI.GUIFeaturesMonadicPaper.html#8767" class="Function">FeatureMachineMonadicΣ</a> <a id="10505" href="GUI.GUIFeaturesMonadicPaper.html#10352" class="Bound">S</a> <a id="10507" href="GUI.GUIFeaturesMonadicPaper.html#10350" class="Bound">F</a> <a id="10509" href="GUI.GUIFeaturesMonadicPaper.html#10361" class="Bound">S&#39;</a><a id="10511" class="Symbol">)</a>
                         <a id="10538" class="Symbol">→</a> <a id="10540" href="GUI.GUIFeaturesPart2Paper.html#934" class="Function">StateMachine</a> <a id="10553" class="Symbol">(</a><a id="10554" href="GUI.GUIFeaturesMonadicPaper.html#10352" class="Bound">S</a> <a id="10556" href="Data.Sum.Base.html#414" class="Datatype Operator">⊎</a> <a id="10558" class="Symbol">(</a><a id="10559" href="Data.Product.html#473" class="Record">Σ</a> <a id="10561" href="GUI.GUIFeaturesMonadicPaper.html#10350" class="Bound">F</a> <a id="10563" href="GUI.GUIFeaturesMonadicPaper.html#10361" class="Bound">S&#39;</a><a id="10565" class="Symbol">))</a>
<a id="10568" href="GUI.GUIFeaturesMonadicPaper.html#10319" class="Function">combineStateFeatureMachineΣ</a> <a id="10596" class="Symbol">{</a><a id="10597" href="GUI.GUIFeaturesMonadicPaper.html#10597" class="Bound">F</a><a id="10598" class="Symbol">}</a> <a id="10600" class="Symbol">{</a><a id="10601" href="GUI.GUIFeaturesMonadicPaper.html#10601" class="Bound">S</a><a id="10602" class="Symbol">}</a> <a id="10604" class="Symbol">{</a><a id="10605" href="GUI.GUIFeaturesMonadicPaper.html#10605" class="Bound">S&#39;</a><a id="10607" class="Symbol">}</a> <a id="10609" href="GUI.GUIFeaturesMonadicPaper.html#10609" class="Bound">machine1</a> <a id="10618" href="GUI.GUIFeaturesMonadicPaper.html#10618" class="Bound">machine2</a> <a id="10627" class="Symbol">(</a><a id="10628" href="Data.Sum.Base.html#470" class="InductiveConstructor">inj₁</a> <a id="10633" href="GUI.GUIFeaturesMonadicPaper.html#10633" class="Bound">s</a><a id="10634" class="Symbol">)</a> <a id="10636" class="Symbol">=</a> <a id="10638" href="GUI.GUIFeaturesMonadicPaper.html#10609" class="Bound">machine1</a> <a id="10647" href="GUI.GUIFeaturesMonadicPaper.html#10633" class="Bound">s</a>
<a id="10649" href="GUI.GUIFeaturesMonadicPaper.html#10319" class="Function">combineStateFeatureMachineΣ</a> <a id="10677" class="Symbol">{</a><a id="10678" href="GUI.GUIFeaturesMonadicPaper.html#10678" class="Bound">F</a><a id="10679" class="Symbol">}</a> <a id="10681" class="Symbol">{</a><a id="10682" href="GUI.GUIFeaturesMonadicPaper.html#10682" class="Bound">S</a><a id="10683" class="Symbol">}</a> <a id="10685" class="Symbol">{</a><a id="10686" href="GUI.GUIFeaturesMonadicPaper.html#10686" class="Bound">S&#39;</a><a id="10688" class="Symbol">}</a> <a id="10690" href="GUI.GUIFeaturesMonadicPaper.html#10690" class="Bound">machine1</a> <a id="10699" href="GUI.GUIFeaturesMonadicPaper.html#10699" class="Bound">machine2</a> <a id="10708" class="Symbol">(</a><a id="10709" href="Data.Sum.Base.html#495" class="InductiveConstructor">inj₂</a> <a id="10714" class="Symbol">(</a><a id="10715" href="GUI.GUIFeaturesMonadicPaper.html#10715" class="Bound">f</a> <a id="10717" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="10719" href="GUI.GUIFeaturesMonadicPaper.html#10719" class="Bound">s&#39;</a><a id="10721" class="Symbol">))</a> <a id="10724" class="Symbol">=</a>
   <a id="10729" href="GUI.GUIFeaturesMonadicPaper.html#1323" class="Function">mapMachineState</a>  <a id="10746" class="Symbol">(</a><a id="10747" href="GUI.GUIFeaturesMonadicPaper.html#9778" class="Function">combineStateFeatureMachineauxΣ</a> <a id="10778" href="GUI.GUIFeaturesMonadicPaper.html#10715" class="Bound">f</a><a id="10779" class="Symbol">)</a> <a id="10781" class="Symbol">(</a><a id="10782" href="GUI.GUIFeaturesMonadicPaper.html#10699" class="Bound">machine2</a> <a id="10791" href="GUI.GUIFeaturesMonadicPaper.html#10715" class="Bound">f</a> <a id="10793" href="GUI.GUIFeaturesMonadicPaper.html#10719" class="Bound">s&#39;</a><a id="10795" class="Symbol">)</a>


<a id="10799" class="Comment">{-
combineStateMachineFeatureMachine : {S S&#39; F : Set}
                                (machine1 : StateMachineMonadic S&#39; S)
                                (machine2 :
-}</a>
</pre></body></html>